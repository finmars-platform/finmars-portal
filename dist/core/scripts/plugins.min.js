!function e(t,r,i){function n(a,o){if(!r[a]){if(!t[a]){var d="function"==typeof require&&require;if(!o&&d)return d(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,function(e){var r=t[a][1][e];return n(r?r:e)},c,c.exports,e,t,r,i)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){"use strict";function i(e){e.fn.perfectScrollbar=function(e){return this.each(function(){if("object"==typeof e||"undefined"==typeof e){var t=e;s.get(this)||n.initialize(this,t)}else{var r=e;"update"===r?n.update(this):"destroy"===r&&n.destroy(this)}})}}var n=e("../main"),s=e("../plugin/instances");if("function"==typeof define&&define.amd)define(["jquery"],i);else{var a=window.jQuery?window.jQuery:window.$;"undefined"!=typeof a&&i(a)}t.exports=i},{"../main":7,"../plugin/instances":18}],2:[function(e,t,r){"use strict";function i(e,t){var r=e.className.split(" ");r.indexOf(t)<0&&r.push(t),e.className=r.join(" ")}function n(e,t){var r=e.className.split(" "),i=r.indexOf(t);i>=0&&r.splice(i,1),e.className=r.join(" ")}r.add=function(e,t){e.classList?e.classList.add(t):i(e,t)},r.remove=function(e,t){e.classList?e.classList.remove(t):n(e,t)},r.list=function(e){return e.classList?Array.prototype.slice.apply(e.classList):e.className.split(" ")}},{}],3:[function(e,t,r){"use strict";function i(e,t){return window.getComputedStyle(e)[t]}function n(e,t,r){return"number"==typeof r&&(r=r.toString()+"px"),e.style[t]=r,e}function s(e,t){for(var r in t){var i=t[r];"number"==typeof i&&(i=i.toString()+"px"),e.style[r]=i}return e}var a={};a.e=function(e,t){var r=document.createElement(e);return r.className=t,r},a.appendTo=function(e,t){return t.appendChild(e),e},a.css=function(e,t,r){return"object"==typeof t?s(e,t):"undefined"==typeof r?i(e,t):n(e,t,r)},a.matches=function(e,t){return"undefined"!=typeof e.matches?e.matches(t):"undefined"!=typeof e.matchesSelector?e.matchesSelector(t):"undefined"!=typeof e.webkitMatchesSelector?e.webkitMatchesSelector(t):"undefined"!=typeof e.mozMatchesSelector?e.mozMatchesSelector(t):"undefined"!=typeof e.msMatchesSelector?e.msMatchesSelector(t):void 0},a.remove=function(e){"undefined"!=typeof e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)},a.queryChildren=function(e,t){return Array.prototype.filter.call(e.childNodes,function(e){return a.matches(e,t)})},t.exports=a},{}],4:[function(e,t,r){"use strict";var i=function(e){this.element=e,this.events={}};i.prototype.bind=function(e,t){"undefined"==typeof this.events[e]&&(this.events[e]=[]),this.events[e].push(t),this.element.addEventListener(e,t,!1)},i.prototype.unbind=function(e,t){var r="undefined"!=typeof t;this.events[e]=this.events[e].filter(function(i){return!(!r||i===t)||(this.element.removeEventListener(e,i,!1),!1)},this)},i.prototype.unbindAll=function(){for(var e in this.events)this.unbind(e)};var n=function(){this.eventElements=[]};n.prototype.eventElement=function(e){var t=this.eventElements.filter(function(t){return t.element===e})[0];return"undefined"==typeof t&&(t=new i(e),this.eventElements.push(t)),t},n.prototype.bind=function(e,t,r){this.eventElement(e).bind(t,r)},n.prototype.unbind=function(e,t,r){this.eventElement(e).unbind(t,r)},n.prototype.unbindAll=function(){for(var e=0;e<this.eventElements.length;e++)this.eventElements[e].unbindAll()},n.prototype.once=function(e,t,r){var i=this.eventElement(e),n=function(e){i.unbind(t,n),r(e)};i.bind(t,n)},t.exports=n},{}],5:[function(e,t,r){"use strict";t.exports=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}()},{}],6:[function(e,t,r){"use strict";var i=e("./class"),n=e("./dom"),s=r.toInt=function(e){return parseInt(e,10)||0},a=r.clone=function(e){if(null===e)return null;if(e.constructor===Array)return e.map(a);if("object"==typeof e){var t={};for(var r in e)t[r]=a(e[r]);return t}return e};r.extend=function(e,t){var r=a(e);for(var i in t)r[i]=a(t[i]);return r},r.isEditable=function(e){return n.matches(e,"input,[contenteditable]")||n.matches(e,"select,[contenteditable]")||n.matches(e,"textarea,[contenteditable]")||n.matches(e,"button,[contenteditable]")},r.removePsClasses=function(e){for(var t=i.list(e),r=0;r<t.length;r++){var n=t[r];0===n.indexOf("ps-")&&i.remove(e,n)}},r.outerWidth=function(e){return s(n.css(e,"width"))+s(n.css(e,"paddingLeft"))+s(n.css(e,"paddingRight"))+s(n.css(e,"borderLeftWidth"))+s(n.css(e,"borderRightWidth"))},r.startScrolling=function(e,t){i.add(e,"ps-in-scrolling"),"undefined"!=typeof t?i.add(e,"ps-"+t):(i.add(e,"ps-x"),i.add(e,"ps-y"))},r.stopScrolling=function(e,t){i.remove(e,"ps-in-scrolling"),"undefined"!=typeof t?i.remove(e,"ps-"+t):(i.remove(e,"ps-x"),i.remove(e,"ps-y"))},r.env={isWebKit:"WebkitAppearance"in document.documentElement.style,supportsTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsIePointer:null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(e,t,r){"use strict";var i=e("./plugin/destroy"),n=e("./plugin/initialize"),s=e("./plugin/update");t.exports={initialize:n,update:s,destroy:i}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":21}],8:[function(e,t,r){"use strict";t.exports={handlers:["click-rail","drag-scrollbar","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollXMarginOffset:0,scrollYMarginOffset:0,stopPropagationOnClick:!0,suppressScrollX:!1,suppressScrollY:!1,swipePropagation:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1,theme:"default"}},{}],9:[function(e,t,r){"use strict";var i=e("../lib/helper"),n=e("../lib/dom"),s=e("./instances");t.exports=function(e){var t=s.get(e);t&&(t.event.unbindAll(),n.remove(t.scrollbarX),n.remove(t.scrollbarY),n.remove(t.scrollbarXRail),n.remove(t.scrollbarYRail),i.removePsClasses(e),s.remove(e))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(e,t,r){"use strict";function i(e,t){function r(e){return e.getBoundingClientRect()}var i=function(e){e.stopPropagation()};t.settings.stopPropagationOnClick&&t.event.bind(t.scrollbarY,"click",i),t.event.bind(t.scrollbarYRail,"click",function(i){var s=n.toInt(t.scrollbarYHeight/2),d=t.railYRatio*(i.pageY-window.pageYOffset-r(t.scrollbarYRail).top-s),l=t.railYRatio*(t.railYHeight-t.scrollbarYHeight),c=d/l;0>c?c=0:c>1&&(c=1),o(e,"top",(t.contentHeight-t.containerHeight)*c),a(e),i.stopPropagation()}),t.settings.stopPropagationOnClick&&t.event.bind(t.scrollbarX,"click",i),t.event.bind(t.scrollbarXRail,"click",function(i){var s=n.toInt(t.scrollbarXWidth/2),d=t.railXRatio*(i.pageX-window.pageXOffset-r(t.scrollbarXRail).left-s),l=t.railXRatio*(t.railXWidth-t.scrollbarXWidth),c=d/l;0>c?c=0:c>1&&(c=1),o(e,"left",(t.contentWidth-t.containerWidth)*c-t.negativeScrollAdjustment),a(e),i.stopPropagation()})}var n=e("../../lib/helper"),s=e("../instances"),a=e("../update-geometry"),o=e("../update-scroll");t.exports=function(e){var t=s.get(e);i(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],11:[function(e,t,r){"use strict";function i(e,t){function r(r){var n=i+r*t.railXRatio,a=Math.max(0,t.scrollbarXRail.getBoundingClientRect().left)+t.railXRatio*(t.railXWidth-t.scrollbarXWidth);0>n?t.scrollbarXLeft=0:n>a?t.scrollbarXLeft=a:t.scrollbarXLeft=n;var o=s.toInt(t.scrollbarXLeft*(t.contentWidth-t.containerWidth)/(t.containerWidth-t.railXRatio*t.scrollbarXWidth))-t.negativeScrollAdjustment;l(e,"left",o)}var i=null,n=null,o=function(t){r(t.pageX-n),d(e),t.stopPropagation(),t.preventDefault()},c=function(){s.stopScrolling(e,"x"),t.event.unbind(t.ownerDocument,"mousemove",o)};t.event.bind(t.scrollbarX,"mousedown",function(r){n=r.pageX,i=s.toInt(a.css(t.scrollbarX,"left"))*t.railXRatio,s.startScrolling(e,"x"),t.event.bind(t.ownerDocument,"mousemove",o),t.event.once(t.ownerDocument,"mouseup",c),r.stopPropagation(),r.preventDefault()})}function n(e,t){function r(r){var n=i+r*t.railYRatio,a=Math.max(0,t.scrollbarYRail.getBoundingClientRect().top)+t.railYRatio*(t.railYHeight-t.scrollbarYHeight);0>n?t.scrollbarYTop=0:n>a?t.scrollbarYTop=a:t.scrollbarYTop=n;var o=s.toInt(t.scrollbarYTop*(t.contentHeight-t.containerHeight)/(t.containerHeight-t.railYRatio*t.scrollbarYHeight));l(e,"top",o)}var i=null,n=null,o=function(t){r(t.pageY-n),d(e),t.stopPropagation(),t.preventDefault()},c=function(){s.stopScrolling(e,"y"),t.event.unbind(t.ownerDocument,"mousemove",o)};t.event.bind(t.scrollbarY,"mousedown",function(r){n=r.pageY,i=s.toInt(a.css(t.scrollbarY,"top"))*t.railYRatio,s.startScrolling(e,"y"),t.event.bind(t.ownerDocument,"mousemove",o),t.event.once(t.ownerDocument,"mouseup",c),r.stopPropagation(),r.preventDefault()})}var s=e("../../lib/helper"),a=e("../../lib/dom"),o=e("../instances"),d=e("../update-geometry"),l=e("../update-scroll");t.exports=function(e){var t=o.get(e);i(e,t),n(e,t)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],12:[function(e,t,r){"use strict";function i(e,t){function r(r,i){var n=e.scrollTop;if(0===r){if(!t.scrollbarYActive)return!1;if(0===n&&i>0||n>=t.contentHeight-t.containerHeight&&0>i)return!t.settings.wheelPropagation}var s=e.scrollLeft;if(0===i){if(!t.scrollbarXActive)return!1;if(0===s&&0>r||s>=t.contentWidth-t.containerWidth&&r>0)return!t.settings.wheelPropagation}return!0}var i=!1;t.event.bind(e,"mouseenter",function(){i=!0}),t.event.bind(e,"mouseleave",function(){i=!1});var a=!1;t.event.bind(t.ownerDocument,"keydown",function(l){if(!(l.isDefaultPrevented&&l.isDefaultPrevented()||l.defaultPrevented)){var c=s.matches(t.scrollbarX,":focus")||s.matches(t.scrollbarY,":focus");if(i||c){var h=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(h){if("IFRAME"===h.tagName)h=h.contentDocument.activeElement;else for(;h.shadowRoot;)h=h.shadowRoot.activeElement;if(n.isEditable(h))return}var u=0,_=0;switch(l.which){case 37:u=-30;break;case 38:_=30;break;case 39:u=30;break;case 40:_=-30;break;case 33:_=90;break;case 32:_=l.shiftKey?90:-90;break;case 34:_=-90;break;case 35:_=l.ctrlKey?-t.contentHeight:-t.containerHeight;break;case 36:_=l.ctrlKey?e.scrollTop:t.containerHeight;break;default:return}d(e,"top",e.scrollTop-_),d(e,"left",e.scrollLeft+u),o(e),a=r(u,_),a&&l.preventDefault()}}})}var n=e("../../lib/helper"),s=e("../../lib/dom"),a=e("../instances"),o=e("../update-geometry"),d=e("../update-scroll");t.exports=function(e){var t=a.get(e);i(e,t)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],13:[function(e,t,r){"use strict";function i(e,t){function r(r,i){var n=e.scrollTop;if(0===r){if(!t.scrollbarYActive)return!1;if(0===n&&i>0||n>=t.contentHeight-t.containerHeight&&0>i)return!t.settings.wheelPropagation}var s=e.scrollLeft;if(0===i){if(!t.scrollbarXActive)return!1;if(0===s&&0>r||s>=t.contentWidth-t.containerWidth&&r>0)return!t.settings.wheelPropagation}return!0}function i(e){var t=e.deltaX,r=-1*e.deltaY;return"undefined"!=typeof t&&"undefined"!=typeof r||(t=-1*e.wheelDeltaX/6,r=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,r*=10),t!==t&&r!==r&&(t=0,r=e.wheelDelta),[t,r]}function n(t,r){var i=e.querySelector("textarea:hover, select[multiple]:hover, .ps-child:hover");if(i){if("TEXTAREA"!==i.tagName&&!window.getComputedStyle(i).overflow.match(/(scroll|auto)/))return!1;var n=i.scrollHeight-i.clientHeight;if(n>0&&!(0===i.scrollTop&&r>0||i.scrollTop===n&&0>r))return!0;var s=i.scrollLeft-i.clientWidth;if(s>0&&!(0===i.scrollLeft&&0>t||i.scrollLeft===s&&t>0))return!0}return!1}function o(o){var l=i(o),c=l[0],h=l[1];n(c,h)||(d=!1,t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(h?a(e,"top",e.scrollTop-h*t.settings.wheelSpeed):a(e,"top",e.scrollTop+c*t.settings.wheelSpeed),d=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(c?a(e,"left",e.scrollLeft+c*t.settings.wheelSpeed):a(e,"left",e.scrollLeft-h*t.settings.wheelSpeed),d=!0):(a(e,"top",e.scrollTop-h*t.settings.wheelSpeed),a(e,"left",e.scrollLeft+c*t.settings.wheelSpeed)),s(e),d=d||r(c,h),d&&(o.stopPropagation(),o.preventDefault()))}var d=!1;"undefined"!=typeof window.onwheel?t.event.bind(e,"wheel",o):"undefined"!=typeof window.onmousewheel&&t.event.bind(e,"mousewheel",o)}var n=e("../instances"),s=e("../update-geometry"),a=e("../update-scroll");t.exports=function(e){var t=n.get(e);i(e,t)}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],14:[function(e,t,r){"use strict";function i(e,t){t.event.bind(e,"scroll",function(){s(e)})}var n=e("../instances"),s=e("../update-geometry");t.exports=function(e){var t=n.get(e);i(e,t)}},{"../instances":18,"../update-geometry":19}],15:[function(e,t,r){"use strict";function i(e,t){function r(){var e=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";return 0===e.toString().length?null:e.getRangeAt(0).commonAncestorContainer}function i(){l||(l=setInterval(function(){return s.get(e)?(o(e,"top",e.scrollTop+c.top),o(e,"left",e.scrollLeft+c.left),void a(e)):void clearInterval(l)},50))}function d(){l&&(clearInterval(l),l=null),n.stopScrolling(e)}var l=null,c={top:0,left:0},h=!1;t.event.bind(t.ownerDocument,"selectionchange",function(){e.contains(r())?h=!0:(h=!1,d())}),t.event.bind(window,"mouseup",function(){h&&(h=!1,d())}),t.event.bind(window,"mousemove",function(t){if(h){var r={x:t.pageX,y:t.pageY},s={left:e.offsetLeft,right:e.offsetLeft+e.offsetWidth,top:e.offsetTop,bottom:e.offsetTop+e.offsetHeight};r.x<s.left+3?(c.left=-5,n.startScrolling(e,"x")):r.x>s.right-3?(c.left=5,n.startScrolling(e,"x")):c.left=0,r.y<s.top+3?(s.top+3-r.y<5?c.top=-5:c.top=-20,n.startScrolling(e,"y")):r.y>s.bottom-3?(r.y-s.bottom+3<5?c.top=5:c.top=20,n.startScrolling(e,"y")):c.top=0,0===c.top&&0===c.left?d():i()}})}var n=e("../../lib/helper"),s=e("../instances"),a=e("../update-geometry"),o=e("../update-scroll");t.exports=function(e){var t=s.get(e);i(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],16:[function(e,t,r){"use strict";function i(e,t,r,i){function n(r,i){var n=e.scrollTop,s=e.scrollLeft,a=Math.abs(r),o=Math.abs(i);if(o>a){if(0>i&&n===t.contentHeight-t.containerHeight||i>0&&0===n)return!t.settings.swipePropagation}else if(a>o&&(0>r&&s===t.contentWidth-t.containerWidth||r>0&&0===s))return!t.settings.swipePropagation;return!0}function d(t,r){o(e,"top",e.scrollTop-r),o(e,"left",e.scrollLeft-t),a(e)}function l(){y=!0}function c(){y=!1}function h(e){return e.targetTouches?e.targetTouches[0]:e}function u(e){return!(!e.targetTouches||1!==e.targetTouches.length)||!(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)}function _(e){if(u(e)){j=!0;var t=h(e);g.pageX=t.pageX,g.pageY=t.pageY,m=(new Date).getTime(),null!==b&&clearInterval(b),e.stopPropagation()}}function f(e){if(!j&&t.settings.swipePropagation&&_(e),!y&&j&&u(e)){var r=h(e),i={pageX:r.pageX,pageY:r.pageY},s=i.pageX-g.pageX,a=i.pageY-g.pageY;d(s,a),g=i;var o=(new Date).getTime(),l=o-m;l>0&&(v.x=s/l,v.y=a/l,m=o),n(s,a)&&(e.stopPropagation(),e.preventDefault())}}function p(){!y&&j&&(j=!1,clearInterval(b),b=setInterval(function(){return s.get(e)?Math.abs(v.x)<.01&&Math.abs(v.y)<.01?void clearInterval(b):(d(30*v.x,30*v.y),v.x*=.8,void(v.y*=.8)):void clearInterval(b)},10))}var g={},m=0,v={},b=null,y=!1,j=!1;r&&(t.event.bind(window,"touchstart",l),t.event.bind(window,"touchend",c),t.event.bind(e,"touchstart",_),t.event.bind(e,"touchmove",f),t.event.bind(e,"touchend",p)),i&&(window.PointerEvent?(t.event.bind(window,"pointerdown",l),t.event.bind(window,"pointerup",c),t.event.bind(e,"pointerdown",_),t.event.bind(e,"pointermove",f),t.event.bind(e,"pointerup",p)):window.MSPointerEvent&&(t.event.bind(window,"MSPointerDown",l),t.event.bind(window,"MSPointerUp",c),t.event.bind(e,"MSPointerDown",_),t.event.bind(e,"MSPointerMove",f),t.event.bind(e,"MSPointerUp",p)))}var n=e("../../lib/helper"),s=e("../instances"),a=e("../update-geometry"),o=e("../update-scroll");t.exports=function(e){if(n.env.supportsTouch||n.env.supportsIePointer){var t=s.get(e);i(e,t,n.env.supportsTouch,n.env.supportsIePointer)}}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],17:[function(e,t,r){"use strict";var i=e("../lib/helper"),n=e("../lib/class"),s=e("./instances"),a=e("./update-geometry"),o={"click-rail":e("./handler/click-rail"),"drag-scrollbar":e("./handler/drag-scrollbar"),keyboard:e("./handler/keyboard"),wheel:e("./handler/mouse-wheel"),touch:e("./handler/touch"),selection:e("./handler/selection")},d=e("./handler/native-scroll");t.exports=function(e,t){t="object"==typeof t?t:{},n.add(e,"ps-container");var r=s.add(e);r.settings=i.extend(r.settings,t),n.add(e,"ps-theme-"+r.settings.theme),r.settings.handlers.forEach(function(t){o[t](e)}),d(e),a(e)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(e,t,r){"use strict";function i(e){function t(){d.add(e,"ps-focus")}function r(){d.remove(e,"ps-focus")}var i=this;i.settings=o.clone(l),i.containerWidth=null,i.containerHeight=null,i.contentWidth=null,i.contentHeight=null,i.isRtl="rtl"===c.css(e,"direction"),i.isNegativeScroll=function(){var t=e.scrollLeft,r=null;return e.scrollLeft=-1,r=e.scrollLeft<0,e.scrollLeft=t,r}(),i.negativeScrollAdjustment=i.isNegativeScroll?e.scrollWidth-e.clientWidth:0,i.event=new h,i.ownerDocument=e.ownerDocument||document,i.scrollbarXRail=c.appendTo(c.e("div","ps-scrollbar-x-rail"),e),i.scrollbarX=c.appendTo(c.e("div","ps-scrollbar-x"),i.scrollbarXRail),i.scrollbarX.setAttribute("tabindex",0),i.event.bind(i.scrollbarX,"focus",t),i.event.bind(i.scrollbarX,"blur",r),i.scrollbarXActive=null,i.scrollbarXWidth=null,i.scrollbarXLeft=null,i.scrollbarXBottom=o.toInt(c.css(i.scrollbarXRail,"bottom")),i.isScrollbarXUsingBottom=i.scrollbarXBottom===i.scrollbarXBottom,i.scrollbarXTop=i.isScrollbarXUsingBottom?null:o.toInt(c.css(i.scrollbarXRail,"top")),i.railBorderXWidth=o.toInt(c.css(i.scrollbarXRail,"borderLeftWidth"))+o.toInt(c.css(i.scrollbarXRail,"borderRightWidth")),c.css(i.scrollbarXRail,"display","block"),i.railXMarginWidth=o.toInt(c.css(i.scrollbarXRail,"marginLeft"))+o.toInt(c.css(i.scrollbarXRail,"marginRight")),c.css(i.scrollbarXRail,"display",""),i.railXWidth=null,i.railXRatio=null,i.scrollbarYRail=c.appendTo(c.e("div","ps-scrollbar-y-rail"),e),i.scrollbarY=c.appendTo(c.e("div","ps-scrollbar-y"),i.scrollbarYRail),i.scrollbarY.setAttribute("tabindex",0),i.event.bind(i.scrollbarY,"focus",t),i.event.bind(i.scrollbarY,"blur",r),i.scrollbarYActive=null,i.scrollbarYHeight=null,i.scrollbarYTop=null,i.scrollbarYRight=o.toInt(c.css(i.scrollbarYRail,"right")),i.isScrollbarYUsingRight=i.scrollbarYRight===i.scrollbarYRight,i.scrollbarYLeft=i.isScrollbarYUsingRight?null:o.toInt(c.css(i.scrollbarYRail,"left")),i.scrollbarYOuterWidth=i.isRtl?o.outerWidth(i.scrollbarY):null,i.railBorderYWidth=o.toInt(c.css(i.scrollbarYRail,"borderTopWidth"))+o.toInt(c.css(i.scrollbarYRail,"borderBottomWidth")),c.css(i.scrollbarYRail,"display","block"),i.railYMarginHeight=o.toInt(c.css(i.scrollbarYRail,"marginTop"))+o.toInt(c.css(i.scrollbarYRail,"marginBottom")),c.css(i.scrollbarYRail,"display",""),i.railYHeight=null,i.railYRatio=null}function n(e){return e.getAttribute("data-ps-id")}function s(e,t){e.setAttribute("data-ps-id",t)}function a(e){e.removeAttribute("data-ps-id")}var o=e("../lib/helper"),d=e("../lib/class"),l=e("./default-setting"),c=e("../lib/dom"),h=e("../lib/event-manager"),u=e("../lib/guid"),_={};r.add=function(e){var t=u();return s(e,t),_[t]=new i(e),_[t]},r.remove=function(e){delete _[n(e)],a(e)},r.get=function(e){return _[n(e)]}},{"../lib/class":2,"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(e,t,r){"use strict";function i(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}function n(e,t){var r={width:t.railXWidth};t.isRtl?r.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:r.left=e.scrollLeft,t.isScrollbarXUsingBottom?r.bottom=t.scrollbarXBottom-e.scrollTop:r.top=t.scrollbarXTop+e.scrollTop,o.css(t.scrollbarXRail,r);var i={top:e.scrollTop,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?i.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth:i.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?i.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:i.left=t.scrollbarYLeft+e.scrollLeft,o.css(t.scrollbarYRail,i),o.css(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),o.css(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}var s=e("../lib/helper"),a=e("../lib/class"),o=e("../lib/dom"),d=e("./instances"),l=e("./update-scroll");t.exports=function(e){var t=d.get(e);t.containerWidth=e.clientWidth,t.containerHeight=e.clientHeight,t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight;var r;e.contains(t.scrollbarXRail)||(r=o.queryChildren(e,".ps-scrollbar-x-rail"),r.length>0&&r.forEach(function(e){o.remove(e)}),o.appendTo(t.scrollbarXRail,e)),e.contains(t.scrollbarYRail)||(r=o.queryChildren(e,".ps-scrollbar-y-rail"),r.length>0&&r.forEach(function(e){o.remove(e)}),o.appendTo(t.scrollbarYRail,e)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=i(t,s.toInt(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=s.toInt((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=i(t,s.toInt(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=s.toInt(e.scrollTop*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),n(e,t),t.scrollbarXActive?a.add(e,"ps-active-x"):(a.remove(e,"ps-active-x"),t.scrollbarXWidth=0,t.scrollbarXLeft=0,l(e,"left",0)),t.scrollbarYActive?a.add(e,"ps-active-y"):(a.remove(e,"ps-active-y"),t.scrollbarYHeight=0,t.scrollbarYTop=0,l(e,"top",0))}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-scroll":20}],20:[function(e,t,r){"use strict";var i,n,s=e("./instances"),a=document.createEvent("Event"),o=document.createEvent("Event"),d=document.createEvent("Event"),l=document.createEvent("Event"),c=document.createEvent("Event"),h=document.createEvent("Event"),u=document.createEvent("Event"),_=document.createEvent("Event"),f=document.createEvent("Event"),p=document.createEvent("Event");a.initEvent("ps-scroll-up",!0,!0),o.initEvent("ps-scroll-down",!0,!0),d.initEvent("ps-scroll-left",!0,!0),l.initEvent("ps-scroll-right",!0,!0),c.initEvent("ps-scroll-y",!0,!0),h.initEvent("ps-scroll-x",!0,!0),u.initEvent("ps-x-reach-start",!0,!0),_.initEvent("ps-x-reach-end",!0,!0),f.initEvent("ps-y-reach-start",!0,!0),p.initEvent("ps-y-reach-end",!0,!0),t.exports=function(e,t,r){if("undefined"==typeof e)throw"You must provide an element to the update-scroll function";if("undefined"==typeof t)throw"You must provide an axis to the update-scroll function";if("undefined"==typeof r)throw"You must provide a value to the update-scroll function";"top"===t&&0>=r&&(e.scrollTop=r=0,e.dispatchEvent(f)),"left"===t&&0>=r&&(e.scrollLeft=r=0,e.dispatchEvent(u));var g=s.get(e);"top"===t&&r>=g.contentHeight-g.containerHeight&&(r=g.contentHeight-g.containerHeight,r-e.scrollTop<=1?r=e.scrollTop:e.scrollTop=r,e.dispatchEvent(p)),"left"===t&&r>=g.contentWidth-g.containerWidth&&(r=g.contentWidth-g.containerWidth,r-e.scrollLeft<=1?r=e.scrollLeft:e.scrollLeft=r,e.dispatchEvent(_)),i||(i=e.scrollTop),n||(n=e.scrollLeft),"top"===t&&i>r&&e.dispatchEvent(a),"top"===t&&r>i&&e.dispatchEvent(o),"left"===t&&n>r&&e.dispatchEvent(d),"left"===t&&r>n&&e.dispatchEvent(l),"top"===t&&(e.scrollTop=i=r,e.dispatchEvent(c)),"left"===t&&(e.scrollLeft=n=r,e.dispatchEvent(h))}},{"./instances":18}],21:[function(e,t,r){"use strict";var i=e("../lib/helper"),n=e("../lib/dom"),s=e("./instances"),a=e("./update-geometry"),o=e("./update-scroll");t.exports=function(e){var t=s.get(e);t&&(t.negativeScrollAdjustment=t.isNegativeScroll?e.scrollWidth-e.clientWidth:0,n.css(t.scrollbarXRail,"display","block"),n.css(t.scrollbarYRail,"display","block"),t.railXMarginWidth=i.toInt(n.css(t.scrollbarXRail,"marginLeft"))+i.toInt(n.css(t.scrollbarXRail,"marginRight")),t.railYMarginHeight=i.toInt(n.css(t.scrollbarYRail,"marginTop"))+i.toInt(n.css(t.scrollbarYRail,"marginBottom")),n.css(t.scrollbarXRail,"display","none"),n.css(t.scrollbarYRail,"display","none"),a(e),o(e,"top",e.scrollTop),o(e,"left",e.scrollLeft),n.css(t.scrollbarXRail,"display",""),n.css(t.scrollbarYRail,"display",""))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19,"./update-scroll":20}]},{},[1]),function t(e,r,i){function n(a,o){if(!r[a]){if(!e[a]){var d="function"==typeof require&&require;if(!o&&d)return d(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return n(r?r:t)},c,c.exports,t,e,r,i)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){"use strict";function i(){n=window.fancyLoggerTheme&&"dark"==window.fancyLoggerTheme?{property:"65,199,132",collection:"79,195,247",event:"239,83,80",controller:"224,224,224",component:"179,157,219",service:"236,64,122"}:{property:"216,67,21",collection:"46,125,50",event:"0,176,255",controller:"36,36,36",component:"179,157,219",service:"255,64,129"}}var n={property:"216,67,21",collection:"46,125,50",event:"0,176,255",controller:"36,36,36",component:"179,157,219",service:"255,64,129"},s=function(e,t){return t<10?"rgba("+e+" ,."+t+")":"rgba("+e+" , 1)"},a=function(e,t,r,a){i();var o=r||10,d=a||"color: "+s(n.property,o);console.log('%c{"property": "'+e+'", "value": "',d,t,'"}')},o=function(e,t,r,a){i();var o=r||10,d=a||"color: "+s(n.collection,o);console.log('%c{"collection": "'+e+'", "data":',d,t,"}")},d=function(e,t,r,a){i();var o=r||10,d=a||"color: "+s(n.event,o);console.log('%c{"event": "'+e+'", "data": "'+t+'"}',d)},l=function(e,t,r,a){i();var o=r||10,d=a||"color: "+s(n.controller,o);console.log('%c{"controller": "'+e+'", "status": "'+t+'"}',d)},c=function(e,t,r,a){i();var o=r||10,d=a||"color: "+s(n.component,o);console.log('%c{"component": "'+e+'", "status": "'+t+'"}',d)},h=function(e,t,r,a){i();var o=r||10,d=a||"color: "+s(n.service,o);console.log('%c{"service": "'+e+'", "status": "'+t+'"}',d)},u={property:a,collection:o,event:d,controller:l,component:c,service:h};t.exports=u,"function"==typeof define&&define.amd?define(u):window.fancyLogger=u},{}]},{},[1]),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var r,i,n=0,s=!1,a=!1,o=!1,d=[],l=e("script:last").attr("src"),c=window.document,h=c.createElement("LI");h.setAttribute("role","treeitem"),r=c.createElement("I"),r.className="jstree-icon jstree-ocl",r.setAttribute("role","presentation"),h.appendChild(r),r=c.createElement("A"),r.className="jstree-anchor",r.setAttribute("href","#"),r.setAttribute("tabindex","-1"),i=c.createElement("I"),i.className="jstree-icon jstree-themeicon",i.setAttribute("role","presentation"),r.appendChild(i),h.appendChild(r),r=i=null,e.jstree={version:"3.3.1",defaults:{plugins:[]},plugins:{},path:l&&l.indexOf("/")!==-1?l.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,r){var i=new e.jstree.core((++n)),s=r;return r=e.extend(!0,{},e.jstree.defaults,r),s&&s.plugins&&(r.plugins=s.plugins),e.each(r.plugins,function(e,t){"core"!==e&&(i=i.plugin(t,r[t]))}),e(t).data("jstree",i),i.init(t,r),i},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(c).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var r=null,i=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!i||!i.length)try{i=e(t)}catch(n){}if(!i||!i.length)try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(n){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:e(".jstree").each(function(){var i=e(this).data("jstree");if(i&&i._model.data[t])return r=i,!1}),r},e.fn.jstree=function(r){var i="string"==typeof r,n=Array.prototype.slice.call(arguments,1),s=null;return!(r===!0&&!this.length)&&(this.each(function(){var a=e.jstree.reference(this),o=i&&a?a[r]:null;if(s=i&&o?o.apply(a,n):null,a||i||r!==t&&!e.isPlainObject(r)||e.jstree.create(this,r),(a&&!i||r===!0)&&(s=a||!1),null!==s&&s!==t)return!1}),null!==s&&s!==t?s:this)},e.expr[":"].jstree=e.expr.createPseudo(function(r){return function(r){return e(r).hasClass("jstree")&&e(r).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,r){var i=e.jstree.plugins[t];return i?(this._data[t]={},i.prototype=this,new i(r,this)):this},init:function(t,r){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=r,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root);
},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(t){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",r=null,i=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(c.selection&&c.selection.empty)c.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(r){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),i=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==c.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var r=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(r=this.get_parent(t.currentTarget),r&&r.id!==e.jstree.root&&this.get_node(r,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault(),r=this.get_prev_dom(t.currentTarget),r&&r.length&&r.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(r=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],r&&e(this._firstChild(r)).children(".jstree-anchor").focus());break;case 40:t.preventDefault(),r=this.get_next_dom(t.currentTarget),r&&r.length&&r.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),r=this._firstChild(this.get_container_ul()[0]),r&&e(r).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:t.preventDefault(),this.edit(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,r){r.status&&(r.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,r,i=[];for(t=0,r=this._data.core.selected.length;t<r;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(i=e.vakata.array_unique(i),t=0,r=i.length;t<r;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(i){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!0;r&&clearTimeout(r),r=setTimeout(function(){t=""},500);var n=String.fromCharCode(i.which).toLowerCase(),s=this.element.find(".jstree-anchor").filter(":visible"),a=s.index(c.activeElement)||0,o=!1;if(t+=n,t.length>1){if(s.slice(a).each(e.proxy(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),o=!0,!1},this)),o)return;if(s.slice(0,a).each(e.proxy(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).focus(),o=!0,!1},this)),o)return}if(new RegExp("^"+n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(s.slice(a+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===n)return e(r).focus(),o=!0,!1},this)),o)return;if(s.slice(0,a+1).each(e.proxy(function(t,r){if(e(r).text().toLowerCase().charAt(0)===n)return e(r).focus(),o=!0,!1},this)),o)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var r=this.get_node(t.currentTarget);r&&r.id&&(this._data.core.focused=r.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-i>500&&!this._data.core.focused){i=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(c).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var r=this.settings.core.strings;return e.isFunction(r)?r.call(this,t):r&&r[t]?r[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,r){t&&t.id&&(t=t.id);var i;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(i=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=e(t,this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=e(t,this.element)).length||!i.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return r&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(n){return!1}},get_path:function(t,r,i){if(t=t.parents?t:this.get_node(t),!t||t.id===e.jstree.root||!t.parents)return!1;var n,s,a=[];for(a.push(i?t.id:t.text),n=0,s=t.parents.length;n<s;n++)a.push(i?t.parents[n]:this.get_text(t.parents[n]));return a=a.reverse().slice(1),r?a.join(r):a},get_next_dom:function(t,r){var i;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do i=this._nextSibling(i);while(i&&0===i.offsetHeight);return!!i&&e(i)}if(t.hasClass("jstree-open")){for(i=this._firstChild(t.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return e(i)}i=t[0];do i=this._nextSibling(i);while(i&&0===i.offsetHeight);return null!==i?e(i):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,r){var i;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do i=this._previousSibling(i);while(i&&0===i.offsetHeight);return!!i&&e(i)}i=t[0];do i=this._previousSibling(i);while(i&&0===i.offsetHeight);if(null!==i){for(t=e(i);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return i=t[0].parentNode.parentNode,!(!i||!i.className||i.className.indexOf("jstree-node")===-1)&&e(i)},get_parent:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,r){var i,n,s,a,o;if(e.isArray(t))return this._load_nodes(t.slice(),r),!0;if(t=this.get_node(t),!t)return r&&r.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,s=0,a=t.parents.length;s<a;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_filter(this._model.data[t.parents[s]].children_d,function(r){return e.inArray(r,t.children_d)===-1});for(i=0,n=t.children_d.length;i<n;i++)this._model.data[t.children_d[i]].state.selected&&(o=!0),delete this._model.data[t.children_d[i]];o&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(r){return e.inArray(r,t.children_d)===-1})),t.children=[],t.children_d=[],o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var i=this.get_node(t,!0),n=0,s=0,a=this._model.data,o=!1;for(n=0,s=t.children.length;n<s;n++)if(a[t.children[n]]&&!a[t.children[n]].state.hidden){o=!0;break}t.state.loaded&&i&&i.length&&(i.removeClass("jstree-closed jstree-open jstree-leaf"),o?"#"!==t.id&&i.addClass(t.state.opened?"jstree-open":"jstree-closed"):i.addClass("jstree-leaf")),i.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),r&&r.call(this,t,e)},this)),!0},_load_nodes:function(e,t,r,i){var n,s,a=!0,o=function(){this._load_nodes(e,t,!0)},d=this._model.data,l=[];for(n=0,s=e.length;n<s;n++)d[e[n]]&&(!d[e[n]].state.loaded&&!d[e[n]].state.failed||!r&&i)&&(this.is_loading(e[n])||this.load_node(e[n],o),a=!1);if(a){for(n=0,s=e.length;n<s;n++)d[e[n]]&&d[e[n]].state.loaded&&l.push(e[n]);t&&!t.done&&(t.call(this,l),t.done=!0)}},load_all:function(t,r){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var i,n,s=[],a=this._model.data,o=a[t.id].children_d;for(t.state&&!t.state.loaded&&s.push(t.id),i=0,n=o.length;i<n;i++)a[o[i]]&&a[o[i]].state&&!a[o[i]].state.loaded&&s.push(o[i]);s.length?this._load_nodes(s,function(){this.load_all(t,r)}):(r&&r.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,r){var i,n=this.settings.core.data;return n?e.isFunction(n)?n.call(this,t,e.proxy(function(i){i===!1?r.call(this,!1):this["string"==typeof i?"_append_html_data":"_append_json_data"](t,"string"==typeof i?e(e.parseHTML(i)).filter(function(){return 3!==this.nodeType}):i,function(e){r.call(this,e)})},this)):"object"==typeof n?n.url?(n=e.extend(!0,{},n),e.isFunction(n.url)&&(n.url=n.url.call(this,t)),e.isFunction(n.data)&&(n.data=n.data.call(this,t)),e.ajax(n).done(e.proxy(function(i,n,s){var a=s.getResponseHeader("Content-Type");return a&&a.indexOf("json")!==-1||"object"==typeof i?this._append_json_data(t,i,function(e){r.call(this,e)}):a&&a.indexOf("html")!==-1||"string"==typeof i?this._append_html_data(t,e(e.parseHTML(i)).filter(function(){return 3!==this.nodeType}),function(e){r.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:s})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))},this)).fail(e.proxy(function(e){r.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(i=e.isArray(n)||e.isPlainObject(n)?JSON.parse(JSON.stringify(n)):n,t.id===e.jstree.root?this._append_json_data(t,i,function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))):"string"==typeof n?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(n)).filter(function(){return 3!==this.nodeType}),function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1)):r.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){r.call(this,e)}):r.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,r,i){t=this.get_node(t),t.children=[],t.children_d=[];var n,s,a,o=r.is("ul")?r.children():r,d=t.id,l=[],c=[],h=this._model.data,u=h[d],_=this._data.core.selected.length;for(o.each(e.proxy(function(t,r){n=this._parse_model_from_html(e(r),d,u.parents.concat()),n&&(l.push(n),c.push(n),h[n].children_d.length&&(c=c.concat(h[n].children_d)))},this)),u.children=l,u.children_d=c,s=0,a=u.parents.length;s<a;s++)h[u.parents[s]].children_d=h[u.parents[s]].children_d.concat(c);this.trigger("model",{nodes:c,parent:d}),d!==e.jstree.root?(this._node_changed(d),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==_&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(t,r,i,n){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],r.d&&(r=r.d,"string"==typeof r&&(r=JSON.parse(r))),e.isArray(r)||(r=[r]);var s=null,a={df:this._model.default_state,dat:r,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var r,i,n,s,a=e.dat,o=e.par,d=[],l=[],c=[],h=e.df,u=e.t_id,_=e.t_cnt,f=e.m,p=f[o],g=e.sel,m=function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,s,a,o,d=e.id.toString(),l={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in h)h.hasOwnProperty(n)&&(l.state[n]=h[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(l.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(l.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(l.li_attr[n]=e.li_attr[n]);if(l.li_attr.id||(l.li_attr.id=d),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(l.a_attr[n]=e.a_attr[n]);for(e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),f[l.id]=l,n=0,s=l.children.length;n<s;n++)a=m(f[l.children[n]],l.id,i),o=f[a],l.children_d.push(a),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d));return delete e.data,delete e.children,f[l.id].original=e,l.state.selected&&c.push(l.id),l.id},v=function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,s,a,o,d,l=!1;do l="j"+u+"_"+ ++_;while(f[l]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in h)h.hasOwnProperty(n)&&(d.state[n]=h[n]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(d.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(d.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(d.li_attr[n]=e.li_attr[n]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=l),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(d.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,s=e.children.length;n<s;n++)a=v(e.children[n],d.id,i),o=f[a],d.children.push(a),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,f[d.id]=d,d.state.selected&&c.push(d.id),d.id};if(a.length&&a[0].id!==t&&a[0].parent!==t){for(i=0,n=a.length;i<n;i++)a[i].children||(a[i].children=[]),f[a[i].id.toString()]=a[i];for(i=0,n=a.length;i<n;i++)f[a[i].parent.toString()].children.push(a[i].id.toString()),p.children_d.push(a[i].id.toString());for(i=0,n=p.children.length;i<n;i++)r=m(f[p.children[i]],o,p.parents.concat()),l.push(r),f[r].children_d.length&&(l=l.concat(f[r].children_d));for(i=0,n=p.parents.length;i<n;i++)f[p.parents[i]].children_d=f[p.parents[i]].children_d.concat(l);s={cnt:_,mod:f,sel:g,par:o,dpc:l,add:c}}else{for(i=0,n=a.length;i<n;i++)r=v(a[i],o,p.parents.concat()),r&&(d.push(r),l.push(r),f[r].children_d.length&&(l=l.concat(f[r].children_d)));for(p.children=d,p.children_d=l,i=0,n=p.parents.length;i<n;i++)f[p.parents[i]].children_d=f[p.parents[i]].children_d.concat(l);s={cnt:_,mod:f,sel:g,par:o,dpc:l,add:c}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?s:void postMessage(s)},d=function(t,r){if(null!==this.element){this._cnt=t.cnt;var n,s=this._model.data;for(n in s)s.hasOwnProperty(n)&&s[n].state&&s[n].state.loading&&t.mod[n]&&(t.mod[n].state.loading=!0);if(this._model.data=t.mod,r){var a,o=t.add,d=t.sel,l=this._data.core.selected.slice();if(s=this._model.data,d.length!==l.length||e.vakata.array_unique(d.concat(l)).length!==d.length){for(n=0,a=d.length;n<a;n++)e.inArray(d[n],o)===-1&&e.inArray(d[n],l)===-1&&(s[d[n]].state.selected=!1);for(n=0,a=l.length;n<a;n++)e.inArray(l[n],d)===-1&&(s[l[n]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||n?(this._data.core.working=!0,s=new window.Worker(this._wrk),s.onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{s.terminate(),s=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),a.par?s.postMessage(a):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,r,i,!0])}catch(l){d.call(this,o(a),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else d.call(this,o(a),!1)}},_parse_model_from_html:function(r,i,n){n=n?[].concat(n):[],i&&n.unshift(i);var s,a,o,d,l,c=this._model.data,h={id:!1,text:!1,icon:!0,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(h.state[o]=this._model.default_state[o]);if(d=e.vakata.attributes(r,!0),e.each(d,function(t,r){return r=e.trim(r),!r.length||(h.li_attr[t]=r,void("id"===t&&(h.id=r.toString())))}),d=r.children("a").first(),d.length&&(d=e.vakata.attributes(d,!0),e.each(d,function(t,r){r=e.trim(r),r.length&&(h.a_attr[t]=r)})),d=r.children("a").first().length?r.children("a").first().clone():r.clone(),d.children("ins, i, ul").remove(),d=d.html(),d=e("<div />").html(d),h.text=this.settings.core.force_text?d.text():d.html(),d=r.data(),h.data=d?e.extend(!0,{},d):null,h.state.opened=r.hasClass("jstree-open"),h.state.selected=r.children("a").hasClass("jstree-clicked"),h.state.disabled=r.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(o in h.data.jstree)h.data.jstree.hasOwnProperty(o)&&(h.state[o]=h.data.jstree[o]);d=r.children("a").children(".jstree-themeicon"),d.length&&(h.icon=!d.hasClass("jstree-themeicon-hidden")&&d.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),d=r.children("ul").children("li");do l="j"+this._id+"_"+ ++this._cnt;while(c[l]);return h.id=h.li_attr.id?h.li_attr.id.toString():l,d.length?(d.each(e.proxy(function(t,r){s=this._parse_model_from_html(e(r),h.id,n),a=this._model.data[s],h.children.push(s),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d))},this)),h.children_d=h.children_d.concat(h.children)):r.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),c[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,s,a,o,d=e.id.toString(),l=this._model.data,c=this._model.default_state,h={id:d,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in c)c.hasOwnProperty(n)&&(h.state[n]=c[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(h.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(h.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(h.li_attr[n]=e.li_attr[n]);if(h.li_attr.id||(h.li_attr.id=d),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(h.a_attr[n]=e.a_attr[n]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),l[h.id]=h,n=0,s=h.children.length;n<s;n++)a=this._parse_model_from_flat_json(l[h.children[n]],h.id,i),o=l[a],h.children_d.push(a),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d));return delete e.data,delete e.children,l[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,s,a,o,d,l=!1,c=this._model.data,h=this._model.default_state;do l="j"+this._id+"_"+ ++this._cnt;while(c[l]);d={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in h)h.hasOwnProperty(n)&&(d.state[n]=h[n]);if(e&&e.id&&(d.id=e.id.toString()),e&&e.text&&(d.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(d.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(d.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(d.li_attr[n]=e.li_attr[n]);if(d.li_attr.id&&!d.id&&(d.id=d.li_attr.id.toString()),d.id||(d.id=l),d.li_attr.id||(d.li_attr.id=d.id),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(d.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,s=e.children.length;n<s;n++)a=this._parse_model_from_json(e.children[n],d.id,i),o=c[a],d.children.push(a),o.children_d.length&&(d.children_d=d.children_d.concat(o.children_d));d.children_d=d.children_d.concat(d.children)}return e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),delete e.data,delete e.children,d.original=e,c[d.id]=d,d.state.selected&&this._data.core.selected.push(d.id),d.id},_redraw:function(){var t,r,i,n=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),s=c.createElement("UL"),a=this._data.core.focused;for(r=0,i=n.length;r<i;r++)t=this.redraw_node(n[r],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&s.appendChild(t);this._model.force_full_redraw&&(s.className=this.get_container_ul()[0].className,s.setAttribute("role","group"),this.element.empty().append(s)),null!==a&&(t=this.get_node(a,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==c.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:n})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var r=this.get_node(t),i=!1,n=!1,s=!1,a=c;if(!r)return!1;if(r.id===e.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for(s=a.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",i=0,n=r.children.length;i<n;i++)s.appendChild(this.redraw_node(r.children[i],!0,!0));t.appendChild(s)}},redraw_node:function(t,r,i,n){var s=this.get_node(t),a=!1,o=!1,d=!1,l=!1,u=!1,_=!1,f="",p=c,g=this._model.data,m=!1,v=null,b=0,y=0,j=!1,k=!1;if(!s)return!1;if(s.id===e.jstree.root)return this.redraw(!0);if(r=r||0===s.children.length,t=c.querySelector?this.element[0].querySelector("#"+("0123456789".indexOf(s.id[0])!==-1?"\\3"+s.id[0]+" "+s.id.substr(1).replace(e.jstree.idregex,"\\$&"):s.id.replace(e.jstree.idregex,"\\$&"))):c.getElementById(s.id))t=e(t),i||(a=t.parent().parent()[0],a===this.element[0]&&(a=null),o=t.index()),r||!s.children.length||t.children(".jstree-children").length||(r=!0),r||(d=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===c.activeElement,t.remove();else if(r=!0,!i){if(a=s.parent!==e.jstree.root?e("#"+s.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===a||a&&g[s.parent].state.opened))return!1;o=e.inArray(s.id,null===a?g[e.jstree.root].children:g[s.parent].children)}t=h.cloneNode(!0),f="jstree-node ";for(l in s.li_attr)if(s.li_attr.hasOwnProperty(l)){if("id"===l)continue;"class"!==l?t.setAttribute(l,s.li_attr[l]):f+=s.li_attr[l]}for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),t.setAttribute("aria-selected",!!s.state.selected),t.setAttribute("aria-level",s.parents.length),t.setAttribute("aria-labelledby",s.a_attr.id),s.state.disabled&&t.setAttribute("aria-disabled",!0),l=0,u=s.children.length;l<u;l++)if(!g[s.children[l]].state.hidden){j=!0;break}if(null!==s.parent&&g[s.parent]&&!s.state.hidden&&(l=e.inArray(s.id,g[s.parent].children),k=s.id,l!==-1))for(l++,u=g[s.parent].children.length;l<u&&(g[g[s.parent].children[l]].state.hidden||(k=g[s.parent].children[l]),k===s.id);l++);s.state.hidden&&(f+=" jstree-hidden"),s.state.loaded&&!j?f+=" jstree-leaf":(f+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),k===s.id&&(f+=" jstree-last"),t.id=s.id,t.className=f,f=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":"");for(u in s.a_attr)if(s.a_attr.hasOwnProperty(u)){if("href"===u&&"#"===s.a_attr[u])continue;"class"!==u?t.childNodes[1].setAttribute(u,s.a_attr[u]):f+=" "+s.a_attr[u]}if(f.length&&(t.childNodes[1].className="jstree-anchor "+f),(s.icon&&s.icon!==!0||s.icon===!1)&&(s.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":s.icon.indexOf("/")===-1&&s.icon.indexOf(".")===-1?t.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+s.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(p.createTextNode(s.text)):t.childNodes[1].innerHTML+=s.text,r&&s.children.length&&(s.state.opened||n)&&s.state.loaded){for(_=p.createElement("UL"),_.setAttribute("role","group"),_.className="jstree-children",l=0,u=s.children.length;l<u;l++)_.appendChild(this.redraw_node(s.children[l],r,!0));t.appendChild(_)}if(d&&t.appendChild(d),!i){for(a||(a=this.element[0]),l=0,u=a.childNodes.length;l<u;l++)if(a.childNodes[l]&&a.childNodes[l].className&&a.childNodes[l].className.indexOf("jstree-children")!==-1){v=a.childNodes[l];break}v||(v=p.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",a.appendChild(v)),a=v,o<a.childNodes.length?a.insertBefore(t,a.childNodes[o]):a.appendChild(t),m&&(b=this.element[0].scrollTop,y=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=b,this.element[0].scrollLeft=y)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(s.id,!1,0)},this),0)),t},open_node:function(r,i,n){var s,a,o,d;if(e.isArray(r)){for(r=r.slice(),s=0,a=r.length;s<a;s++)this.open_node(r[s],i,n);return!0}return r=this.get_node(r),!(!r||r.id===e.jstree.root)&&(n=n===t?this.settings.core.animation:n,this.is_closed(r)?this.is_loaded(r)?(o=this.get_node(r,!0),d=this,o.length&&(n&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),r.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(r),n?(this.trigger("before_open",{node:r}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(n,function(){this.style.display="",d.element&&d.trigger("after_open",{
node:r})})):(this.trigger("before_open",{node:r}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].setAttribute("aria-expanded",!0))),r.state.opened=!0,i&&i.call(this,r,!0),o.length||this.trigger("before_open",{node:r}),this.trigger("open_node",{node:r}),n&&o.length||this.trigger("after_open",{node:r}),!0):this.is_loading(r)?setTimeout(e.proxy(function(){this.open_node(r,i,n)},this),500):void this.load_node(r,function(e,t){return t?this.open_node(e,i,n):!!i&&i.call(this,e,!1)}):(i&&i.call(this,r,!1),!1))},_open_to:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var r,i,n=t.parents;for(r=0,i=n.length;r<i;r+=1)r!==e.jstree.root&&this.open_node(n[r],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(r,i){var n,s,a,o;if(e.isArray(r)){for(r=r.slice(),n=0,s=r.length;n<s;n++)this.close_node(r[n],i);return!0}return r=this.get_node(r),!(!r||r.id===e.jstree.root)&&(!this.is_closed(r)&&(i=i===t?this.settings.core.animation:i,a=this,o=this.get_node(r,!0),r.state.opened=!1,this.trigger("close_node",{node:r}),void(o.length?i?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",o.children(".jstree-children").remove(),a.element&&a.trigger("after_close",{node:r})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:r})):this.trigger("after_close",{node:r}))))},toggle_node:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.toggle_node(t[r]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,r,i){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var n,s,a,o=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!o.length){for(n=0,s=t.children_d.length;n<s;n++)this.is_closed(this._model.data[t.children_d[n]])&&(this._model.data[t.children_d[n]].state.opened=!0);return this.trigger("open_all",{node:t})}i=i||o,a=this,o=this.is_closed(t)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){a.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,r,i)},r||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(t,r){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var i,n,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),a=this;for(s.length&&(s=this.is_open(t)?s.find(".jstree-open").addBack():s.find(".jstree-open"),e(s.get().reverse()).each(function(){a.close_node(this,r||0)})),i=0,n=t.children_d.length;i<n;i++)this._model.data[t.children_d[i]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.enable_node(t[r]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t}))},disable_node:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.disable_node(t[r]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t}))},is_hidden:function(e){return e=this.get_node(e),e.state.hidden===!0},hide_node:function(t,r){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.hide_node(t[i],!0);return r||this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),r||this.redraw(),this.trigger("hide_node",{node:t})))},show_node:function(t,r){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.show_node(t[i],!0);return r||this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),r||this.redraw(),this.trigger("show_node",{node:t})))},hide_all:function(t){var r,i=this._model.data,n=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&!i[r].state.hidden&&(i[r].state.hidden=!0,n.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:n}),n},show_all:function(t){var r,i=this._model.data,n=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&i[r].state.hidden&&(i[r].state.hidden=!1,n.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:n}),n},activate_node:function(e,r){if(this.is_disabled(e))return!1;if(r&&"object"==typeof r||(r={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&(!r.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(r.shiftKey){var i,n,s=this.get_node(e).id,a=this._data.core.last_clicked.id,o=this.get_node(this._data.core.last_clicked.parent).children,d=!1;for(i=0,n=o.length;i<n;i+=1)o[i]===s&&(d=!d),o[i]===a&&(d=!d),this.is_disabled(o[i])||!d&&o[i]!==s&&o[i]!==a?this.deselect_node(o[i],!0,r):this.is_hidden(o[i])||this.select_node(o[i],!0,!1,r);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:r})}else this.is_selected(e)?this.deselect_node(e,!1,r):this.select_node(e,!1,!1,r);else!this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,r):(this.deselect_all(!0),this.select_node(e,!1,!1,r),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:r})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),r=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return e=this.get_node(e,!0),!!(e&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)}))},select_node:function(t,r,i,n){var s,a,o;if(e.isArray(t)){for(t=t.slice(),a=0,o=t.length;a<o;a++)this.select_node(t[a],r,i,n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),i||(s=this._open_to(t)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:n}),r||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:n}))))},deselect_node:function(t,r,i){var n,s,a;if(e.isArray(t)){for(t=t.slice(),n=0,s=t.length;n<s;n++)this.deselect_node(t[n],r,i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(a=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:i}),r||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:i}))))},select_all:function(t){var r,i,n=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),r=0,i=this._data.core.selected.length;r<i;r++)this._model.data[this._data.core.selected[r]]&&(this._model.data[this._data.core.selected[r]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:n})},deselect_all:function(e){var t,r,i=this._data.core.selected.concat([]);for(t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var r,i,n,s,a=this.get_selected(!0),o={};for(r=0,i=a.length;r<i;r++)o[a[r].id]=a[r];for(r=0,i=a.length;r<i;r++)for(n=0,s=a[r].children_d.length;n<s;n++)o[a[r].children_d[n]]&&delete o[a[r].children_d[n]];a=[];for(r in o)o.hasOwnProperty(r)&&a.push(r);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},get_bottom_selected:function(t){var r,i,n=this.get_selected(!0),s=[];for(r=0,i=n.length;r<i;r++)n[r].children.length||s.push(n[r].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_state:function(){var t,r={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&r.core.open.push(t),this._model.data[t].state.selected&&r.core.selected.push(t));return r},set_state:function(r,i){if(r){if(r.core){var n,s;if(r.core.open)return e.isArray(r.core.open)&&r.core.open.length?this._load_nodes(r.core.open,function(e){this.open_node(e,!1,0),delete r.core.open,this.set_state(r,i)},!0):(delete r.core.open,this.set_state(r,i)),!1;if(r.core.scroll)return r.core.scroll&&r.core.scroll.left!==t&&this.element.scrollLeft(r.core.scroll.left),r.core.scroll&&r.core.scroll.top!==t&&this.element.scrollTop(r.core.scroll.top),delete r.core.scroll,this.set_state(r,i),!1;if(r.core.selected)return n=this,this.deselect_all(),e.each(r.core.selected,function(e,t){n.select_node(t,!1,!0)}),delete r.core.selected,this.set_state(r,i),!1;for(s in r)r.hasOwnProperty(s)&&"core"!==s&&e.inArray(s,this.settings.plugins)===-1&&delete r[s];if(e.isEmptyObject(r.core))return delete r.core,this.set_state(r,i),!1}return!e.isEmptyObject(r)||(r=null,i&&i.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,r){this._data.core.state=r===!0?{}:this.get_state(),r&&e.isFunction(r)&&(this._data.core.state=r.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,r){r&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var r=[],i=[],n=this._data.core.selected.concat([]);i.push(t.id),t.state.opened===!0&&r.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id),r.push(this.id)}),this._load_nodes(i,e.proxy(function(e){this.open_node(r,!1,0),this.select_node(n),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,r){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var i,n,s=this._model.data,a=t.id;for(r=r.toString(),s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=r,i=0,n=t.parents.length;i<n;i++)s[t.parents[i]].children_d[e.inArray(t.id,s[t.parents[i]].children_d)]=r;for(i=0,n=t.children.length;i<n;i++)s[t.children[i]].parent=r;for(i=0,n=t.children_d.length;i<n;i++)s[t.children_d[i]].parents[e.inArray(t.id,s[t.children_d[i]].parents)]=r;return i=e.inArray(t.id,this._data.core.selected),i!==-1&&(this._data.core.selected[i]=r),i=this.get_node(t.id,!0),i&&(i.attr("id",r),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",r)),delete s[t.id],t.id=r,t.li_attr.id=r,s[r]=t,this.trigger("set_id",{node:t,"new":t.id,old:a}),!0},get_text:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.text},set_text:function(t,r){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.set_text(t[i],r);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.text=r,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:r}),!0)},get_json:function(t,r,i){if(t=this.get_node(t||e.jstree.root),!t)return!1;r&&r.flat&&!i&&(i=[]);var n,s,a={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!r||!r.no_data)&&e.extend(!0,{},t.data)};if(r&&r.flat?a.parent=t.parent:a.children=[],!r||!r.no_state)for(n in t.state)t.state.hasOwnProperty(n)&&(a.state[n]=t.state[n]);if(r&&r.no_id&&(delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id),r&&r.flat&&t.id!==e.jstree.root&&i.push(a),!r||!r.no_children)for(n=0,s=t.children.length;n<s;n++)r&&r.flat?this.get_json(t.children[n],r,i):a.children.push(this.get_json(t.children[n],r));return r&&r.flat?i:t.id===e.jstree.root?a.children:a},create_node:function(r,i,n,s,a){if(null===r&&(r=e.jstree.root),r=this.get_node(r),!r)return!1;if(n=n===t?"last":n,!n.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(r))return this.load_node(r,function(){this.create_node(r,i,n,s,!0)});i||(i={text:this.get_string("New node")}),"string"==typeof i&&(i={text:i}),i.text===t&&(i.text=this.get_string("New node"));var o,d,l,c;switch(r.id===e.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":o=this.get_node(r.parent),n=e.inArray(r.id,o.children),r=o;break;case"after":o=this.get_node(r.parent),n=e.inArray(r.id,o.children)+1,r=o;break;case"inside":case"first":n=0;break;case"last":n=r.children.length;break;default:n||(n=0)}if(n>r.children.length&&(n=r.children.length),i.id||(i.id=!0),!this.check("create_node",i,r,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.id===!0&&delete i.id,i=this._parse_model_from_json(i,r.id,r.parents.concat()),!i)return!1;for(o=this.get_node(i),d=[],d.push(i),d=d.concat(o.children_d),this.trigger("model",{nodes:d,parent:r.id}),r.children_d=r.children_d.concat(d),l=0,c=r.parents.length;l<c;l++)this._model.data[r.parents[l]].children_d=this._model.data[r.parents[l]].children_d.concat(d);for(i=o,o=[],l=0,c=r.children.length;l<c;l++)o[l>=n?l+1:l]=r.children[l];return o[n]=i.id,r.children=o,this.redraw_node(r,!0),s&&s.call(this,this.get_node(i)),this.trigger("create_node",{node:this.get_node(i),parent:r.id,position:n}),i.id},rename_node:function(t,r){var i,n,s;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.rename_node(t[i],r);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=t.text,this.check("rename_node",t,this.get_parent(t),r)?(this.set_text(t,r),this.trigger("rename_node",{node:t,text:r,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var r,i,n,s,a,o,d,l,c,h,u,_;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.delete_node(t[r]);return!0}if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;if(n=this.get_node(t.parent),s=e.inArray(t.id,n.children),h=!1,!this.check("delete_node",t,n,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(s!==-1&&(n.children=e.vakata.array_remove(n.children,s)),a=t.children_d.concat([]),a.push(t.id),o=0,d=t.parents.length;o<d;o++)this._model.data[t.parents[o]].children_d=e.vakata.array_filter(this._model.data[t.parents[o]].children_d,function(t){return e.inArray(t,a)===-1});for(l=0,c=a.length;l<c;l++)if(this._model.data[a[l]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return e.inArray(t,a)===-1})),this.trigger("delete_node",{node:t,parent:n.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:n.id}),l=0,c=a.length;l<c;l++)delete this._model.data[a[l]];return e.inArray(this._data.core.focused,a)!==-1&&(this._data.core.focused=null,u=this.element[0].scrollTop,_=this.element[0].scrollLeft,n.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(n,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=_),this.redraw_node(n,!0),!0},check:function(t,r,i,n,s){r=r&&r.id?r:this.get_node(r),i=i&&i.id?i:this.get_node(i);var a=t.match(/^move_node|copy_node|create_node$/i)?i:r,o=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||s&&s.is_multi||r.id!==i.id&&("move_node"!==t||e.inArray(r.id,i.children)!==n)&&e.inArray(i.id,r.children_d)===-1?(a&&a.data&&(a=a.data),a&&a.functions&&(a.functions[t]===!1||a.functions[t]===!0)?(a.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),a.functions[t]):!(o===!1||e.isFunction(o)&&o.call(this,t,r,i,n,s)===!1||o&&o[t]===!1)||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(r,i,n,s,a,o,d){var l,c,h,u,_,f,p,g,m,v,b,y,j,k;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(r,i,n,s,!0,!1,d)});if(e.isArray(r)){if(1!==r.length){for(l=0,c=r.length;l<c;l++)(m=this.move_node(r[l],i,n,s,a,!1,d))&&(i=m,n="after");return this.redraw(),!0}r=r[0]}if(r=r&&r.id?r:this.get_node(r),!r||r.id===e.jstree.root)return!1;if(h=(r.parent||e.jstree.root).toString(),_=n.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,f=d?d:this._model.data[r.id]?this:e.jstree.reference(r.id),p=!f||!f._id||this._id!==f._id,u=f&&f._id&&h&&f._model.data[h]&&f._model.data[h].children?e.inArray(r.id,f._model.data[h].children):-1,f&&f._id&&(r=f._model.data[r.id]),p)return!!(m=this.copy_node(r,i,n,s,a,!1,d))&&(f&&f.delete_node(r),m);switch(i.id===e.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=e.inArray(i.id,_.children);break;case"after":n=e.inArray(i.id,_.children)+1;break;case"inside":case"first":n=0;break;case"last":n=_.children.length;break;default:n||(n=0)}if(n>_.children.length&&(n=_.children.length),!this.check("move_node",r,_,n,{core:!0,origin:d,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.parent===_.id){for(g=_.children.concat(),m=e.inArray(r.id,g),m!==-1&&(g=e.vakata.array_remove(g,m),n>m&&n--),m=[],v=0,b=g.length;v<b;v++)m[v>=n?v+1:v]=g[v];m[n]=r.id,_.children=m,this._node_changed(_.id),this.redraw(_.id===e.jstree.root)}else{for(m=r.children_d.concat(),m.push(r.id),v=0,b=r.parents.length;v<b;v++){for(g=[],k=f._model.data[r.parents[v]].children_d,y=0,j=k.length;y<j;y++)e.inArray(k[y],m)===-1&&g.push(k[y]);f._model.data[r.parents[v]].children_d=g}for(f._model.data[h].children=e.vakata.array_remove_item(f._model.data[h].children,r.id),v=0,b=_.parents.length;v<b;v++)this._model.data[_.parents[v]].children_d=this._model.data[_.parents[v]].children_d.concat(m);for(g=[],v=0,b=_.children.length;v<b;v++)g[v>=n?v+1:v]=_.children[v];for(g[n]=r.id,_.children=g,_.children_d.push(r.id),_.children_d=_.children_d.concat(r.children_d),r.parent=_.id,m=_.parents.concat(),m.unshift(_.id),k=r.parents.length,r.parents=m,m=m.concat(),v=0,b=r.children_d.length;v<b;v++)this._model.data[r.children_d[v]].parents=this._model.data[r.children_d[v]].parents.slice(0,k*-1),Array.prototype.push.apply(this._model.data[r.children_d[v]].parents,m);h!==e.jstree.root&&_.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(_.id)),o||this.redraw()}return s&&s.call(this,r,_,n),this.trigger("move_node",{node:r,parent:_.id,position:n,old_parent:h,old_position:u,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id,old_instance:f,new_instance:this}),r.id},copy_node:function(r,i,n,s,a,o,d){var l,c,h,u,_,f,p,g,m,v,b;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(r,i,n,s,!0,!1,d)});if(e.isArray(r)){if(1!==r.length){for(l=0,c=r.length;l<c;l++)(u=this.copy_node(r[l],i,n,s,a,!0,d))&&(i=u,n="after");return this.redraw(),!0}r=r[0]}if(r=r&&r.id?r:this.get_node(r),!r||r.id===e.jstree.root)return!1;switch(g=(r.parent||e.jstree.root).toString(),m=n.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,v=d?d:this._model.data[r.id]?this:e.jstree.reference(r.id),b=!v||!v._id||this._id!==v._id,v&&v._id&&(r=v._model.data[r.id]),i.id===e.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=e.inArray(i.id,m.children);break;case"after":n=e.inArray(i.id,m.children)+1;break;case"inside":case"first":n=0;break;case"last":n=m.children.length;break;default:n||(n=0)}if(n>m.children.length&&(n=m.children.length),!this.check("copy_node",r,m,n,{core:!0,origin:d,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(p=v?v.get_json(r,{no_id:!0,no_data:!0,no_state:!0}):r,!p)return!1;if(p.id===!0&&delete p.id,p=this._parse_model_from_json(p,m.id,m.parents.concat()),!p)return!1;for(u=this.get_node(p),r&&r.state&&r.state.loaded===!1&&(u.state.loaded=!1),h=[],h.push(p),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:m.id}),_=0,f=m.parents.length;_<f;_++)this._model.data[m.parents[_]].children_d=this._model.data[m.parents[_]].children_d.concat(h);for(h=[],_=0,f=m.children.length;_<f;_++)h[_>=n?_+1:_]=m.children[_];return h[n]=u.id,m.children=h,m.children_d.push(u.id),m.children_d=m.children_d.concat(u.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),o||this.redraw(m.id===e.jstree.root),s&&s.call(this,u,m,n),this.trigger("copy_node",{node:u,original:r,parent:m.id,position:n,old_parent:g,old_position:v&&v._id&&g&&v._model.data[g]&&v._model.data[g].children?e.inArray(r.id,v._model.data[g].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),u.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,i,n,d=[];for(i=0,n=t.length;i<n;i++)r=this.get_node(t[i]),r&&r.id&&r.id!==e.jstree.root&&d.push(r);return!!d.length&&(s=d,o=this,a="move_node",void this.trigger("cut",{node:t}))},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var r,i,n,d=[];for(i=0,n=t.length;i<n;i++)r=this.get_node(t[i]),r&&r.id&&r.id!==e.jstree.root&&d.push(r);return!!d.length&&(s=d,o=this,a="copy_node",void this.trigger("copy",{node:t}))},get_buffer:function(){return{mode:a,node:s,inst:o}},can_paste:function(){return a!==!1&&s!==!1},paste:function(e,t){return e=this.get_node(e),!!(e&&a&&a.match(/^(copy_node|move_node)$/)&&s)&&(this[a](s,e,t,!1,!1,!1,o)&&this.trigger("paste",{parent:e.id,node:s,mode:a}),s=!1,a=!1,void(o=!1))},clear_buffer:function(){s=!1,a=!1,o=!1,this.trigger("clear_buffer")},edit:function(t,r,i){var n,s,a,o,d,l,h,u,_,f=!1;return!!(t=this.get_node(t))&&(this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(_=t,r="string"==typeof r?r:t.text,this.set_text(t,""),t=this._open_to(t),_.text=r,n=this._data.core.rtl,s=this.element.width(),this._data.core.focused=_.id,a=t.children(".jstree-anchor").focus(),o=e("<span>"),d=r,l=e("<div />",{css:{position:"absolute",top:"-200px",left:n?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h=e("<input />",{value:d,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(r){r.stopImmediatePropagation(),r.preventDefault();var n,s=o.children(".jstree-rename-input"),c=s.val(),u=this.settings.core.force_text;""===c&&(c=d),l.remove(),o.replaceWith(a),o.remove(),d=u?d:e("<div></div>").append(e.parseHTML(d)).html(),this.set_text(t,d),n=!!this.rename_node(t,u?e("<div></div>").text(c).text():e("<div></div>").append(e.parseHTML(c)).html()),n||this.set_text(t,d),this._data.core.focused=_.id,setTimeout(e.proxy(function(){var e=this.get_node(_.id,!0);e.length&&(this._data.core.focused=_.id,e.children(".jstree-anchor").focus())},this),0),i&&i.call(this,_,n,f),h=null},this),keydown:function(e){var t=e.which;27===t&&(f=!0,this.value=d),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h.width(Math.min(l.text("pW"+this.value).width(),s))},keypress:function(e){if(13===e.which)return!1}}),u={fontFamily:a.css("fontFamily")||"",fontSize:a.css("fontSize")||"",fontWeight:a.css("fontWeight")||"",fontStyle:a.css("fontStyle")||"",fontStretch:a.css("fontStretch")||"",fontVariant:a.css("fontVariant")||"",letterSpacing:a.css("letterSpacing")||"",wordSpacing:a.css("wordSpacing")||""},o.attr("class",a.attr("class")).append(a.contents().clone()).append(h),a.replaceWith(o),l.css(u),h.css(u).width(Math.min(l.text("pW"+h[0].value).width(),s))[0].select(),void e(c).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).blur()})))},set_theme:function(t,r){if(!t)return!1;if(r===!0){var i=this.settings.core.themes.dir;i||(i=e.jstree.path+"/themes"),r=i+"/"+t+"/style.css"}r&&e.inArray(r,d)===-1&&(e("head").append('<link rel="stylesheet" href="'+r+'" type="text/css" />'),d.push(r)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(r,i){var n,s,a,o;if(e.isArray(r)){for(r=r.slice(),n=0,s=r.length;n<s;n++)this.set_icon(r[n],i);return!0}return r=this.get_node(r),!(!r||r.id===e.jstree.root)&&(o=r.icon,r.icon=i===!0||null===i||i===t||""===i||i,a=this.get_node(r,!0).children(".jstree-anchor").children(".jstree-themeicon"),i===!1?this.hide_icon(r):i===!0||null===i||i===t||""===i?(a.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),o===!1&&this.show_icon(r)):i.indexOf("/")===-1&&i.indexOf(".")===-1?(a.removeClass(o).css("background",""),a.addClass(i+" jstree-themeicon-custom").attr("rel",i),o===!1&&this.show_icon(r)):(a.removeClass(o).css("background",""),a.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i),o===!1&&this.show_icon(r)),!0)},get_icon:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.hide_icon(t[r]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var r,i,n;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.show_icon(t[r]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(n=this.get_node(t,!0),t.icon=!n.length||n.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),n.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,r){t=e(t)[0];var i=r?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,n){e.inArray(n.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])===-1&&null!==n.value&&""!==e.trim(n.value)&&(r?i[n.name]=n.value:i.push(n.name))}),i},e.vakata.array_unique=function(e){var r,i,n=[],s={};for(r=0,i=e.length;r<i;r++)s[e[r]]===t&&(n.push(e[r]),s[e[r]]=!0);return n},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},
e.vakata.array_remove_item=function(t,r){var i=e.inArray(r,t);return i!==-1?e.vakata.array_remove(t,i):t},e.vakata.array_filter=function(e,t,r,i,n){if(e.filter)return e.filter(t,r);i=[];for(n in e)~~n+""==n+""&&n>=0&&t.call(r,e[n],+n,e)&&i.push(e[n]);return i},e.jstree.plugins.changed=function(e,t){var r=[];this.trigger=function(e,i){var n,s;if(i||(i={}),"changed"===e.replace(".jstree","")){i.changed={selected:[],deselected:[]};var a={};for(n=0,s=r.length;n<s;n++)a[r[n]]=1;for(n=0,s=i.selected.length;n<s;n++)a[i.selected[n]]?a[i.selected[n]]=2:i.changed.selected.push(i.selected[n]);for(n=0,s=r.length;n<s;n++)1===a[r[n]]&&i.changed.deselected.push(r[n]);r=i.selected.slice()}t.trigger.call(this,e,i)},this.refresh=function(e,i){return r=[],t.refresh.apply(this,arguments)}};var u=c.createElement("I");u.className="jstree-icon jstree-checkbox",u.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(r,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),this.settings.checkbox.cascade.indexOf("undetermined")!==-1&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var r,i,n=this._model.data,s=(n[t.parent],t.nodes);for(r=0,i=s.length;r<i;r++)n[s[r]].state.checked=n[s[r]].state.checked||n[s[r]].original&&n[s[r]].original.state&&n[s[r]].original.state.checked,n[s[r]].state.checked&&this._data.checkbox.selected.push(s[r])},this)),this.settings.checkbox.cascade.indexOf("up")===-1&&this.settings.checkbox.cascade.indexOf("down")===-1||this.element.on("model.jstree",e.proxy(function(t,r){var i,n,s,a,o,d,l=this._model.data,c=l[r.parent],h=r.nodes,u=[],_=this.settings.checkbox.cascade,f=this.settings.checkbox.tie_selection;if(_.indexOf("down")!==-1)if(c.state[f?"selected":"checked"]){for(n=0,s=h.length;n<s;n++)l[h[n]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(h)}else for(n=0,s=h.length;n<s;n++)if(l[h[n]].state[f?"selected":"checked"]){for(a=0,o=l[h[n]].children_d.length;a<o;a++)l[l[h[n]].children_d[a]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(l[h[n]].children_d)}if(_.indexOf("up")!==-1){for(n=0,s=c.children_d.length;n<s;n++)l[c.children_d[n]].children.length||u.push(l[c.children_d[n]].parent);for(u=e.vakata.array_unique(u),a=0,o=u.length;a<o;a++)for(c=l[u[a]];c&&c.id!==e.jstree.root;){for(i=0,n=0,s=c.children.length;n<s;n++)i+=l[c.children[n]].state[f?"selected":"checked"];if(i!==s)break;c.state[f?"selected":"checked"]=!0,this._data[f?"core":"checkbox"].selected.push(c.id),d=this.get_node(c,!0),d&&d.length&&d.attr("aria-selected",!0).children(".jstree-anchor").addClass(f?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[f?"core":"checkbox"].selected=e.vakata.array_unique(this._data[f?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,r){var i,n,s,a,o=r.node,d=this._model.data,l=this.get_node(o.parent),c=this.get_node(o,!0),h=this.settings.checkbox.cascade,u=this.settings.checkbox.tie_selection,_={},f=this._data[u?"core":"checkbox"].selected;for(i=0,n=f.length;i<n;i++)_[f[i]]=!0;if(h.indexOf("down")!==-1)for(i=0,n=o.children_d.length;i<n;i++)_[o.children_d[i]]=!0,a=d[o.children_d[i]],a.state[u?"selected":"checked"]=!0,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1);if(h.indexOf("up")!==-1)for(;l&&l.id!==e.jstree.root;){for(s=0,i=0,n=l.children.length;i<n;i++)s+=d[l.children[i]].state[u?"selected":"checked"];if(s!==n)break;l.state[u?"selected":"checked"]=!0,_[l.id]=!0,a=this.get_node(l,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),l=this.get_node(l.parent)}f=[];for(i in _)_.hasOwnProperty(i)&&f.push(i);this._data[u?"core":"checkbox"].selected=f,h.indexOf("down")!==-1&&c.length&&c.find(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(t,r){var i,n,s,a=this.get_node(e.jstree.root),o=this._model.data;for(i=0,n=a.children_d.length;i<n;i++)s=o[a.children_d[i]],s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,r){var i,n,s,a=r.node,o=this.get_node(a,!0),d=this.settings.checkbox.cascade,l=this.settings.checkbox.tie_selection,c=this._data[l?"core":"checkbox"].selected,h={};if(a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),d.indexOf("down")!==-1)for(i=0,n=a.children_d.length;i<n;i++)s=this._model.data[a.children_d[i]],s.state[l?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(d.indexOf("up")!==-1)for(i=0,n=a.parents.length;i<n;i++)s=this._model.data[a.parents[i]],s.state[l?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),s=this.get_node(a.parents[i],!0),s&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked");for(h={},i=0,n=c.length;i<n;i++)d.indexOf("down")!==-1&&e.inArray(c[i],a.children_d)!==-1||d.indexOf("up")!==-1&&e.inArray(c[i],a.parents)!==-1||(h[c[i]]=!0);c=[];for(i in h)h.hasOwnProperty(i)&&c.push(i);this._data[l?"core":"checkbox"].selected=c,d.indexOf("down")!==-1&&o.length&&o.find(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),this.settings.checkbox.cascade.indexOf("up")!==-1&&this.element.on("delete_node.jstree",e.proxy(function(t,r){for(var i,n,s,a,o=this.get_node(r.parent),d=this._model.data,l=this.settings.checkbox.tie_selection;o&&o.id!==e.jstree.root&&!o.state[l?"selected":"checked"];){for(s=0,i=0,n=o.children.length;i<n;i++)s+=d[o.children[i]].state[l?"selected":"checked"];if(!(n>0&&s===n))break;o.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(o.id),a=this.get_node(o,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,r){var i,n,s,a,o,d=r.is_multi,l=r.old_parent,c=this.get_node(r.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!d)for(i=this.get_node(l);i&&i.id!==e.jstree.root&&!i.state[u?"selected":"checked"];){for(n=0,s=0,a=i.children.length;s<a;s++)n+=h[i.children[s]].state[u?"selected":"checked"];if(!(a>0&&n===a))break;i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),o=this.get_node(i,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=c;i&&i.id!==e.jstree.root;){for(n=0,s=0,a=i.children.length;s<a;s++)n+=h[i.children[s]].state[u?"selected":"checked"];if(n===a)i.state[u?"selected":"checked"]||(i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),o=this.get_node(i,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!i.state[u?"selected":"checked"])break;i.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,i.id),o=this.get_node(i,!0),o&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this._undetermined=function(){if(null!==this.element){var r,i,n,s,a={},o=this._model.data,d=this.settings.checkbox.tie_selection,l=this._data[d?"core":"checkbox"].selected,c=[],h=this;for(r=0,i=l.length;r<i;r++)if(o[l[r]]&&o[l[r]].parents)for(n=0,s=o[l[r]].parents.length;n<s&&a[o[l[r]].parents[n]]===t;n++)o[l[r]].parents[n]!==e.jstree.root&&(a[o[l[r]].parents[n]]=!0,c.push(o[l[r]].parents[n]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var d,l=h.get_node(this);if(l.state.loaded){for(r=0,i=l.children_d.length;r<i;r++)if(d=o[l.children_d[r]],!d.state.loaded&&d.original&&d.original.state&&d.original.state.undetermined&&d.original.state.undetermined===!0)for(a[d.id]===t&&d.id!==e.jstree.root&&(a[d.id]=!0,c.push(d.id)),n=0,s=d.parents.length;n<s;n++)a[d.parents[n]]===t&&d.parents[n]!==e.jstree.root&&(a[d.parents[n]]=!0,c.push(d.parents[n]))}else if(l.original&&l.original.state&&l.original.state.undetermined&&l.original.state.undetermined===!0)for(a[l.id]===t&&l.id!==e.jstree.root&&(a[l.id]=!0,c.push(l.id)),n=0,s=l.parents.length;n<s;n++)a[l.parents[n]]===t&&l.parents[n]!==e.jstree.root&&(a[l.parents[n]]=!0,c.push(l.parents[n]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),r=0,i=c.length;r<i;r++)o[c[r]].state[d?"selected":"checked"]||(l=this.get_node(c[r],!0),l&&l.length&&l.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(t,r,n,s){if(t=i.redraw_node.apply(this,arguments)){var a,o,d=null,l=null;for(a=0,o=t.childNodes.length;a<o;a++)if(t.childNodes[a]&&t.childNodes[a].className&&t.childNodes[a].className.indexOf("jstree-anchor")!==-1){d=t.childNodes[a];break}d&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(d.className+=" jstree-checked"),l=u.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(l.className+=" jstree-checkbox-disabled"),d.insertBefore(l,d.childNodes[0]))}return n||this.settings.checkbox.cascade.indexOf("undetermined")===-1||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var r,i,n=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,a=this._data[s?"core":"checkbox"].selected,o=this._model.data;if(!t||t.state[s?"selected":"checked"]===!0||n.indexOf("undetermined")===-1||n.indexOf("down")===-1&&n.indexOf("up")===-1)return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(r=0,i=t.children_d.length;r<i;r++)if(e.inArray(t.children_d[r],a)!==-1||!o[t.children_d[r]].state.loaded&&o[t.children_d[r]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var r,i,n;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.disable_checkbox(t[r]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(n=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))))},this.enable_checkbox=function(t){var r,i,n;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.enable_checkbox(t[r]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(n=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))))},this.activate_node=function(t,r){return!e(r.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))&&(r.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(r.target).hasClass("jstree-checkbox")?i.activate_node.call(this,t,r):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,r):this.check_node(t,r),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,r);var i,n,s;if(e.isArray(t)){for(t=t.slice(),n=0,s=t.length;n<s;n++)this.check_node(t[n],r);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(i=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:r}))))},this.uncheck_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,r);var i,n,s;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;i<n;i++)this.uncheck_node(t[i],r);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:r}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,r;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,r=this._data.checkbox.selected.length;t<r;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,r=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:r})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.checked)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var r,i,n,s,a=this.get_checked(!0),o={};for(r=0,i=a.length;r<i;r++)o[a[r].id]=a[r];for(r=0,i=a.length;r<i;r++)for(n=0,s=a[r].children_d.length;n<s;n++)o[a[r].children_d[n]]&&delete o[a[r].children_d[n]];a=[];for(r in o)o.hasOwnProperty(r)&&a.push(r);return t?e.map(a,e.proxy(function(e){return this.get_node(e)},this)):a},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var r,i,n=this.get_checked(!0),s=[];for(r=0,i=n.length;r<i;r++)n[r].children.length||s.push(n[r].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},this.load_node=function(t,r){var n,s,a,o;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t),o&&o.state.loaded))for(n=0,s=o.children_d.length;n<s;n++)this._model.data[o.children_d[n]].state.checked&&(a=!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[n]));return i.load_node.apply(this,arguments)},this.get_state=function(){var e=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,r){var n=i.set_state.apply(this,arguments);if(n&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var s=this;e.each(t.checkbox,function(e,t){s.check_node(t)})}return delete t.checkbox,this.set_state(t,r),!1}return n},this.refresh=function(e,t){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,r){this.settings.conditionalselect.call(this,this.get_node(e),r)&&t.activate_node.call(this,e,r)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,r){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.create_node(i,{},"last",function(e){setTimeout(function(){r.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.delete_node(r.get_selected()):r.delete_node(i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.cut(r.get_top_selected()):r.cut(i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.is_selected(i)?r.copy(r.get_top_selected()):r.copy(i)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var r=e.jstree.reference(t.reference),i=r.get_node(t.reference);r.paste(i)}}}}}}},e.jstree.plugins.contextmenu=function(r,i){this.bind=function(){i.bind.call(this);var t,r,n=0,s=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),n=e.ctrlKey?+new Date:0,(t||s)&&(n=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){this._data.contextmenu.visible&&(!n||+new Date-n>250)&&e.vakata.context.hide(),n=0},this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(t=i.pageX,r=i.pageY,s=setTimeout(function(){e(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.pageX)>50||Math.abs(r-e.pageY)>50)&&clearTimeout(s)}).on("touchend.vakata.jstree",function(e){s&&clearTimeout(s)}),e(c).on("context_hide.vakata.jstree",e.proxy(function(e,t){this._data.contextmenu.visible=!1,t.reference.removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(r,i,n,s){if(r=this.get_node(r),!r||r.id===e.jstree.root)return!1;var a=this.settings.contextmenu,o=this.get_node(r,!0),d=o.children(".jstree-anchor"),l=!1,c=!1;(a.show_at_node||i===t||n===t)&&(l=d.offset(),i=l.left,n=l.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(r)&&this.activate_node(r,s),c=a.items,e.isFunction(c)&&(c=c.call(this,r,e.proxy(function(e){this._show_contextmenu(r,i,n,e)},this))),e.isPlainObject(c)&&this._show_contextmenu(r,i,n,c)},this._show_contextmenu=function(t,r,i,n){var s=this.get_node(t,!0),a=s.children(".jstree-anchor");e(c).one("context_show.vakata.jstree",e.proxy(function(t,r){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(r.element).addClass(i),a.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:r,y:i},n),this.trigger("show_contextmenu",{node:t,x:r,y:i})}},function(e){var t=!1,r={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(c).triggerHandler("context_"+t+".vakata",{reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_execute:function(t){return t=r.items[t],!(!t||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:r.reference,element:r.element}))||!t.action)&&t.action.call(null,{item:t,reference:r.reference,element:r.element,position:{x:r.position_x,y:r.position_y}})},_parse:function(t,i){if(!t)return!1;i||(r.html="",r.items=[]);var n,s="",a=!1;return i&&(s+="<ul>"),e.each(t,function(t,i){return!i||(r.items.push(i),!a&&i.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),a=!1,s+="<li class='"+(i._class||"")+(i._disabled===!0||e.isFunction(i._disabled)&&i._disabled({item:i,reference:r.reference,element:r.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(r.items.length-1)+"'>",e.vakata.context.settings.icons&&(s+="<i ",i.icon&&(s+=i.icon.indexOf("/")!==-1||i.icon.indexOf(".")!==-1?" style='background:url(\""+i.icon+"\") center center no-repeat' ":" class='"+i.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(i.label)?i.label({item:t,reference:r.reference,element:r.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(n=e.vakata.context._parse(i.submenu,!0),n&&(s+=n)),s+="</li>",void(i.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",a=!0)))}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(s+="</ul>"),i||(r.html=s,e.vakata.context._trigger("parse")),s.length>10&&s},_show_submenu:function(r){if(r=e(r),r.length&&r.children("ul").length){var i=r.children("ul"),n=r.offset().left,s=n+r.outerWidth(),a=r.offset().top,o=i.width(),d=i.height(),l=e(window).width()+e(window).scrollLeft(),c=e(window).height()+e(window).scrollTop();t?r[s-(o+10+r.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):r[s+o>l&&n>l-s?"addClass":"removeClass"]("vakata-context-right"),a+d+10>c&&i.css("bottom","-1px"),r.hasClass("vakata-context-right")?n<o&&i.css("margin-right",n-o):l-s<o&&i.css("margin-left",l-s-o),i.show()}},show:function(i,n,s){var a,o,d,l,c,h,u,_,f=!0;switch(r.element&&r.element.length&&r.element.width(""),f){case!n&&!i:return!1;case!!n&&!!i:r.reference=i,r.position_x=n.x,r.position_y=n.y;break;case!n&&!!i:r.reference=i,a=i.offset(),r.position_x=a.left+i.outerHeight(),r.position_y=a.top;break;case!!n&&!i:r.position_x=n.x,r.position_y=n.y}i&&!s&&e(i).data("vakata_contextmenu")&&(s=e(i).data("vakata_contextmenu")),e.vakata.context._parse(s)&&r.element.html(r.html),r.items.length&&(r.element.appendTo("body"),o=r.element,d=r.position_x,l=r.position_y,c=o.width(),h=o.height(),u=e(window).width()+e(window).scrollLeft(),_=e(window).height()+e(window).scrollTop(),t&&(d-=o.outerWidth()-e(i).outerWidth(),d<e(window).scrollLeft()+20&&(d=e(window).scrollLeft()+20)),d+c+20>u&&(d=u-(c+20)),l+h+20>_&&(l=_-(h+20)),r.element.css({left:d,top:l}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),r.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){r.is_visible&&(r.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),r.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var i=!1;r.element=e("<ul class='vakata-context'></ul>"),r.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(i&&clearTimeout(i),r.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(i=setTimeout(function(t){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var i=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:r.is_visible&&(r.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:r.is_visible&&(i=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),i.length||(i=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:r.is_visible&&(r.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:r.is_visible&&(i=r.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),i.length||(i=r.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=r.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(c).on("mousedown.vakata.jstree",function(t){r.is_visible&&!e.contains(r.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,i){r.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&r.element.addClass("vakata-context-rtl").css("direction","rtl"),r.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var _,f;e.jstree.plugins.dnd=function(t,r){this.init=function(e,t){r.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in c.createElement("span")},this.bind=function(){r.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var r=this.get_node(t.target),i=this.is_selected(r)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,n=i>1?i+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(n=e.vakata.html.escape(n)),r&&r.id&&r.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_top_selected(!0):[r],t))){if(_={jstree:!0,origin:this,obj:this.get_node(r,!0),nodes:i>1?this.get_top_selected():[r.id]},f=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,_,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+n+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:f,data:_})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:f,data:_}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:f,data:_}),!1},this))},this.redraw_node=function(e,t,i,n){if(e=r.redraw_node.apply(this,arguments),e&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var s,a,o=null;for(s=0,a=e.childNodes.length;s<a;s++)if(e.childNodes[s]&&e.childNodes[s].className&&e.childNodes[s].className.indexOf("jstree-anchor")!==-1){o=e.childNodes[s];break}o&&o.setAttribute("draggable",!0)}return e}},e(function(){var r=!1,i=!1,n=!1,s=!1,a=e('<div id="jstree-marker">&#160;</div>').hide();e(c).on("dnd_start.vakata.jstree",function(e,t){r=!1,n=!1,t&&t.data&&t.data.jstree&&a.appendTo("body")}).on("dnd_move.vakata.jstree",function(o,d){if(s&&(d.event&&"dragover"===d.event.type&&d.event.target===n.target||clearTimeout(s)),d&&d.data&&d.data.jstree&&(!d.event.target.id||"jstree-marker"!==d.event.target.id)){n=d.event;var l,c,h,u,_,f,p,g,m,v,b,y,j,k,x,w=e.jstree.reference(d.event.target),C=!1,T=!1,S=!1;if(w&&w._data&&w._data.dnd)if(a.attr("class","jstree-"+w.get_theme()+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")),x=d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey)),d.helper.children().attr("class","jstree-"+w.get_theme()+" jstree-"+w.get_theme()+"-"+w.get_theme_variant()+" "+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[x?"show":"hide"](),
d.event.target!==w.element[0]&&d.event.target!==w.get_container_ul()[0]||0!==w.get_container_ul().children().length){if(C=w.settings.dnd.large_drop_target?e(d.event.target).closest(".jstree-node").children(".jstree-anchor"):e(d.event.target).closest(".jstree-anchor"),C&&C.length&&C.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(T=C.offset(),S=(d.event.pageY!==t?d.event.pageY:d.event.originalEvent.pageY)-T.top,h=C.outerHeight(),f=S<h/3?["b","i","a"]:S>h-h/3?["a","i","b"]:S>h/2?["i","a","b"]:["i","b","a"],e.each(f,function(t,n){switch(n){case"b":l=T.left-6,c=T.top,u=w.get_parent(C),_=C.parent().index();break;case"i":j=w.settings.dnd.inside_pos,k=w.get_node(C.parent()),l=T.left-2,c=T.top+h/2+1,u=k.id,_="first"===j?0:"last"===j?k.children.length:Math.min(j,k.children.length);break;case"a":l=T.left-6,c=T.top+h,u=w.get_parent(C),_=C.parent().index()+1}for(p=!0,g=0,m=d.data.nodes.length;g<m;g++)if(v=d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey))?"copy_node":"move_node",b=_,"move_node"===v&&"a"===n&&d.data.origin&&d.data.origin===w&&u===w.get_parent(d.data.nodes[g])&&(y=w.get_node(u),b>e.inArray(d.data.nodes[g],y.children)&&(b-=1)),p=p&&(w&&w.settings&&w.settings.dnd&&w.settings.dnd.check_while_dragging===!1||w.check(v,d.data.origin&&d.data.origin!==w?d.data.origin.get_node(d.data.nodes[g]):d.data.nodes[g],u,b,{dnd:!0,ref:w.get_node(C.parent()),pos:n,origin:d.data.origin,is_multi:d.data.origin&&d.data.origin!==w,is_foreign:!d.data.origin})),!p){w&&w.last_error&&(i=w.last_error());break}if("i"===n&&C.parent().is(".jstree-closed")&&w.settings.dnd.open_timeout&&(s=setTimeout(function(e,t){return function(){e.open_node(t)}}(w,C),w.settings.dnd.open_timeout)),p)return r={ins:w,par:u,pos:"i"!==n||"last"!==j||0!==_||w.is_loaded(k)?_:"last"},a.css({left:l+"px",top:c+"px"}).show(),d.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),d.event.originalEvent&&d.event.originalEvent.dataTransfer&&(d.event.originalEvent.dataTransfer.dropEffect=x?"copy":"move"),i={},f=!0,!1}),f===!0))return}else{for(p=!0,g=0,m=d.data.nodes.length;g<m&&(p=p&&w.check(d.data.origin&&(d.data.origin.settings.dnd.always_copy||d.data.origin.settings.dnd.copy&&(d.event.metaKey||d.event.ctrlKey))?"copy_node":"move_node",d.data.origin&&d.data.origin!==w?d.data.origin.get_node(d.data.nodes[g]):d.data.nodes[g],e.jstree.root,"last",{dnd:!0,ref:w.get_node(e.jstree.root),pos:"i",origin:d.data.origin,is_multi:d.data.origin&&d.data.origin!==w,is_foreign:!d.data.origin}),p);g++);if(p)return r={ins:w,par:e.jstree.root,pos:"last"},a.hide(),d.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(d.event.originalEvent&&d.event.originalEvent.dataTransfer&&(d.event.originalEvent.dataTransfer.dropEffect=x?"copy":"move"))}r=!1,d.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),d.event.originalEvent&&d.event.originalEvent.dataTransfer&&(d.event.originalEvent.dataTransfer.dropEffect="none"),a.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(a.hide(),r=!1,n=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,o){if(s&&clearTimeout(s),o&&o.data&&o.data.jstree){a.hide().detach();var d,l,c=[];if(r){for(d=0,l=o.data.nodes.length;d<l;d++)c[d]=o.data.origin?o.data.origin.get_node(o.data.nodes[d]):o.data.nodes[d];r.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](c,r.par,r.pos,!1,!1,!1,o.data.origin)}else d=e(o.event.target).closest(".jstree"),d.length&&i&&i.error&&"check"===i.error&&(d=d.jstree(!0),d&&d.settings.core.error.call(this,i));n=!1,r=!1}}).on("keyup.jstree keydown.jstree",function(t,o){o=e.vakata.dnd._get(),o&&o.data&&o.data.jstree&&("keyup"===t.type&&27===t.which?(s&&clearTimeout(s),r=!1,i=!1,n=!1,s=!1,a.hide().detach(),e.vakata.dnd._clean()):(o.helper.find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),n&&(n.metaKey=t.metaKey,n.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",n))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.text(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).text()}};var r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(r,i,n){n===t&&(n=e.vakata.dnd._get()),n.event=i,e(c).triggerHandler("dnd_"+r+".vakata",n)},_get:function(){return{data:r.data,element:r.element,helper:r.helper}},_clean:function(){r.helper&&r.helper.remove(),r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(c).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(c).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!r.scroll_e||!r.scroll_l&&!r.scroll_t)return r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),!1;if(!r.scroll_i)return r.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(t===!0)return!1;var i=r.scroll_e.scrollTop(),n=r.scroll_e.scrollLeft();r.scroll_e.scrollTop(i+r.scroll_t*e.vakata.dnd.settings.scroll_speed),r.scroll_e.scrollLeft(n+r.scroll_l*e.vakata.dnd.settings.scroll_speed),i===r.scroll_e.scrollTop()&&n===r.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",r.scroll_e)},start:function(t,i,n){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=c.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(s){}return r.init_x=t.pageX,r.init_y=t.pageY,r.data=i,r.is_down=!0,r.element=t.currentTarget,r.target=t.target,r.is_touch="touchstart"===t.type,n!==!1&&(r.helper=e("<div id='vakata-dnd'></div>").html(n).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(c).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(c).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=c.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_down){if(!r.is_drag){if(!(Math.abs(t.pageX-r.init_x)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-r.init_y)>(r.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;r.helper&&(r.helper.appendTo("body"),r.helper_w=r.helper.outerWidth()),r.is_drag=!0,e.vakata.dnd._trigger("start",t)}var i=!1,n=!1,s=!1,a=!1,o=!1,d=!1,l=!1,h=!1,u=!1,_=!1;return r.scroll_t=0,r.scroll_l=0,r.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=e(this),n=i.offset();if(this.scrollHeight>this.offsetHeight&&(n.top+i.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),t.pageY-n.top<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(n.left+i.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),t.pageX-n.left<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1)),r.scroll_t||r.scroll_l)return r.scroll_e=e(this),!1}),r.scroll_e||(i=e(c),n=e(window),s=i.height(),a=n.height(),o=i.width(),d=n.width(),l=i.scrollTop(),h=i.scrollLeft(),s>a&&t.pageY-l<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1),s>a&&a-(t.pageY-l)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),o>d&&t.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1),o>d&&d-(t.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),(r.scroll_t||r.scroll_l)&&(r.scroll_e=i)),r.scroll_e&&e.vakata.dnd._scroll(!0),r.helper&&(u=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),_=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),s&&u+25>s&&(u=s-50),o&&_+r.helper_w>o&&(_=o-(r.helper_w+2)),r.helper.css({left:_+"px",top:u+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=c.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag)e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===r.target){var i=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){i&&clearTimeout(i)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,r){this.init=function(e,t){this._data.massload={},r.init.call(this,e,t)},this._load_nodes=function(t,i,n,s){var a,o,d,l=this.settings.massload,c=(JSON.stringify(t),[]),h=this._model.data;if(!n){for(a=0,o=t.length;a<o;a++)h[t[a]]&&(h[t[a]].state.loaded||h[t[a]].state.failed)&&!s||(c.push(t[a]),d=this.get_node(t[a],!0),d&&d.length&&d.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},c.length){if(e.isFunction(l))return l.call(this,c,e.proxy(function(e){var a,o;if(e)for(a in e)e.hasOwnProperty(a)&&(this._data.massload[a]=e[a]);for(a=0,o=t.length;a<o;a++)d=this.get_node(t[a],!0),d&&d.length&&d.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,n,s)},this));if("object"==typeof l&&l&&l.url)return l=e.extend(!0,{},l),e.isFunction(l.url)&&(l.url=l.url.call(this,c)),e.isFunction(l.data)&&(l.data=l.data.call(this,c)),e.ajax(l).done(e.proxy(function(e,a,o){var l,c;if(e)for(l in e)e.hasOwnProperty(l)&&(this._data.massload[l]=e[l]);for(l=0,c=t.length;l<c;l++)d=this.get_node(t[l],!0),d&&d.length&&d.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,n,s)},this)).fail(e.proxy(function(e){r._load_nodes.call(this,t,i,n,s)},this))}}return r._load_nodes.call(this,t,i,n,s)},this._load_node=function(t,i){var n,s=this._data.massload[t.id],a=null;return s?(a=this["string"==typeof s?"_append_html_data":"_append_json_data"](t,"string"==typeof s?e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}):s,function(e){i.call(this,e)}),n=this.get_node(t.id,!0),n&&n.length&&n.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],a):r._load_node.call(this,t,i)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(r,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,r){if(this._data.search.som&&r.res.length){var i,n,s,a,o=this._model.data,d=[];for(i=0,n=r.res.length;i<n;i++)if(o[r.res[i]]&&!o[r.res[i]].state.hidden&&(d.push(r.res[i]),d=d.concat(o[r.res[i]].parents),this._data.search.smc))for(s=0,a=o[r.res[i]].children_d.length;s<a;s++)o[o[r.res[i]].children_d[s]]&&!o[o[r.res[i]].children_d[s]].state.hidden&&d.push(o[r.res[i]].children_d[s]);d=e.vakata.array_remove_item(e.vakata.array_unique(d),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(d,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(r,i,n,s,a,o){if(r===!1||""===e.trim(r.toString()))return this.clear_search();s=this.get_node(s),s=s&&s.id?s.id:null,r=r.toString();var d,l,c=this.settings.search,h=!!c.ajax&&c.ajax,u=this._model.data,_=null,f=[],p=[];if(this._data.search.res.length&&!a&&this.clear_search(),n===t&&(n=c.show_only_matches),o===t&&(o=c.show_only_matches_children),!i&&h!==!1)return e.isFunction(h)?h.call(this,r,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,n,s,a)})},this),s):(h=e.extend({},h),h.data||(h.data={}),h.data.str=r,s&&(h.data.inside=s),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,n,s,a)})},this)));if(a||(this._data.search.str=r,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=n,this._data.search.smc=o),_=new e.vakata.search(r,(!0),{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy}),e.each(u[s?s:e.jstree.root].children_d,function(e,t){var i=u[t];i.text&&!i.state.hidden&&(!c.search_leaves_only||i.state.loaded&&0===i.children.length)&&(c.search_callback&&c.search_callback.call(this,r,i)||!c.search_callback&&_.search(i.text).isMatch)&&(f.push(t),p=p.concat(i.parents))}),f.length){for(p=e.vakata.array_unique(p),d=0,l=p.length;d<l;d++)p[d]!==e.jstree.root&&u[p[d]]&&this.open_node(p[d],null,0)===!0&&this._data.search.opn.push(p[d]);a?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(f,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(f))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(f,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=f),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:r,res:this._data.search.res,show_only_matches:n})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,r,n,s){if(t=i.redraw_node.apply(this,arguments),t&&e.inArray(t.id,this._data.search.res)!==-1){var a,o,d=null;for(a=0,o=t.childNodes.length;a<o;a++)if(t.childNodes[a]&&t.childNodes[a].className&&t.childNodes[a].className.indexOf("jstree-anchor")!==-1){d=t.childNodes[a];break}d&&(d.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,r,i){i=i||{},i=e.extend({},e.vakata.search.defaults,i),i.fuzzy!==!1&&(i.fuzzy=!0),t=i.caseSensitive?t:t.toLowerCase();var n,s,a,o,d=i.location,l=i.distance,c=i.threshold,h=t.length;return h>32&&(i.fuzzy=!1),i.fuzzy&&(n=1<<h-1,s=function(){var e={},r=0;for(r=0;r<h;r++)e[t.charAt(r)]=0;for(r=0;r<h;r++)e[t.charAt(r)]|=1<<h-r-1;return e}(),a=function(e,t){var r=e/h,i=Math.abs(d-t);return l?r+i/l:i?1:r}),o=function(e){if(e=i.caseSensitive?e:e.toLowerCase(),t===e||e.indexOf(t)!==-1)return{isMatch:!0,score:0};if(!i.fuzzy)return{isMatch:!1,score:1};var r,o,l,u,_,f,p,g,m,v=e.length,b=c,y=e.indexOf(t,d),j=h+v,k=1,x=[];for(y!==-1&&(b=Math.min(a(0,y),b),y=e.lastIndexOf(t,d+h),y!==-1&&(b=Math.min(a(0,y),b))),y=-1,r=0;r<h;r++){for(l=0,u=j;l<u;)a(r,d+u)<=b?l=u:j=u,u=Math.floor((j-l)/2+l);for(j=u,f=Math.max(1,d-u+1),p=Math.min(d+u,v)+h,g=new Array(p+2),g[p+1]=(1<<r)-1,o=p;o>=f;o--)if(m=s[e.charAt(o-1)],0===r?g[o]=(g[o+1]<<1|1)&m:g[o]=(g[o+1]<<1|1)&m|((_[o+1]|_[o])<<1|1)|_[o+1],g[o]&n&&(k=a(r,o-1),k<=b)){if(b=k,y=o-1,x.push(y),!(y>d))break;f=Math.max(1,2*d-y)}if(a(r+1,d)>b)break;_=g}return{isMatch:y>=0,score:k}},r===!0?{search:o}:o(r)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,r){var i,n;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),r))for(i=0,n=t.children_d.length;i<n;i++)this.sort(t.children_d[i],!1)}};var p=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,r){this.bind=function(){r.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){p&&clearTimeout(p),p=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(e,r){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(r){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(r,i){i.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={"default":{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(r,i){this.init=function(r,n){var s,a;if(n&&n.types&&n.types["default"])for(s in n.types)if("default"!==s&&s!==e.jstree.root&&n.types.hasOwnProperty(s))for(a in n.types["default"])n.types["default"].hasOwnProperty(a)&&n.types[s][a]===t&&(n.types[s][a]=n.types["default"][a]);i.init.call(this,r,n),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,r){i.refresh.call(this,t,r),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(r,i){var n,s,a,o=this._model.data,d=i.nodes,l=this.settings.types,c="default";for(n=0,s=d.length;n<s;n++){if(c="default",o[d[n]].original&&o[d[n]].original.type&&l[o[d[n]].original.type]&&(c=o[d[n]].original.type),o[d[n]].data&&o[d[n]].data.jstree&&o[d[n]].data.jstree.type&&l[o[d[n]].data.jstree.type]&&(c=o[d[n]].data.jstree.type),o[d[n]].type=c,o[d[n]].icon===!0&&l[c].icon!==t&&(o[d[n]].icon=l[c].icon),l[c].li_attr!==t&&"object"==typeof l[c].li_attr)for(a in l[c].li_attr)if(l[c].li_attr.hasOwnProperty(a)){if("id"===a)continue;o[d[n]].li_attr[a]===t?o[d[n]].li_attr[a]=l[c].li_attr[a]:"class"===a&&(o[d[n]].li_attr["class"]=l[c].li_attr["class"]+" "+o[d[n]].li_attr["class"])}if(l[c].a_attr!==t&&"object"==typeof l[c].a_attr)for(a in l[c].a_attr)if(l[c].a_attr.hasOwnProperty(a)){if("id"===a)continue;o[d[n]].a_attr[a]===t?o[d[n]].a_attr[a]=l[c].a_attr[a]:"href"===a&&"#"===o[d[n]].a_attr[a]?o[d[n]].a_attr.href=l[c].a_attr.href:"class"===a&&(o[d[n]].a_attr["class"]=l[c].a_attr["class"]+" "+o[d[n]].a_attr["class"])}}o[e.jstree.root].type=e.jstree.root},this)),i.bind.call(this)},this.get_json=function(t,r,n){var s,a,o=this._model.data,d=r?e.extend(!0,{},r,{no_id:!1}):{},l=i.get_json.call(this,t,d,n);if(l===!1)return!1;if(e.isArray(l))for(s=0,a=l.length;s<a;s++)l[s].type=l[s].id&&o[l[s].id]&&o[l[s].id].type?o[l[s].id].type:"default",r&&r.no_id&&(delete l[s].id,l[s].li_attr&&l[s].li_attr.id&&delete l[s].li_attr.id,l[s].a_attr&&l[s].a_attr.id&&delete l[s].a_attr.id);else l.type=l.id&&o[l.id]&&o[l.id].type?o[l.id].type:"default",r&&r.no_id&&(l=this._delete_ids(l));return l},this._delete_ids=function(t){if(e.isArray(t)){for(var r=0,i=t.length;r<i;r++)t[r]=this._delete_ids(t[r]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(r,n,s,a,o){if(i.check.call(this,r,n,s,a,o)===!1)return!1;n=n&&n.id?n:this.get_node(n),s=s&&s.id?s:this.get_node(s);var d,l,c,h,u=n&&n.id?o&&o.origin?o.origin:e.jstree.reference(n.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,r){case"create_node":case"move_node":case"copy_node":if("move_node"!==r||e.inArray(n.id,s.children)===-1){if(d=this.get_rules(s),d.max_children!==t&&d.max_children!==-1&&d.max_children===s.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+r,data:JSON.stringify({chk:r,pos:a,obj:!(!n||!n.id)&&n.id,par:!(!s||!s.id)&&s.id})},!1;if(d.valid_children!==t&&d.valid_children!==-1&&e.inArray(n.type||"default",d.valid_children)===-1)return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+r,data:JSON.stringify({chk:r,pos:a,obj:!(!n||!n.id)&&n.id,par:!(!s||!s.id)&&s.id})},!1;if(u&&n.children_d&&n.parents){for(l=0,c=0,h=n.children_d.length;c<h;c++)l=Math.max(l,u[n.children_d[c]].parents.length);l=l-n.parents.length+1}(l<=0||l===t)&&(l=1);do{if(d.max_depth!==t&&d.max_depth!==-1&&d.max_depth<l)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+r,data:JSON.stringify({chk:r,pos:a,obj:!(!n||!n.id)&&n.id,par:!(!s||!s.id)&&s.id})},!1;s=this.get_node(s.parent),d=this.get_rules(s),l++}while(s)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var r=this.get_type(e,!0);return r.max_depth===t&&(r.max_depth=-1),r.max_children===t&&(r.max_children=-1),r.valid_children===t&&(r.valid_children=-1),r},this.get_type=function(t,r){return t=this.get_node(t),!!t&&(r?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(r,i){var n,s,a,o,d,l,c,h,u=this._model.data;if(e.isArray(r)){for(r=r.slice(),s=0,a=r.length;s<a;s++)this.set_type(r[s],i);return!0}if(n=this.settings.types,r=this.get_node(r),!n[i]||!r)return!1;if(c=this.get_node(r,!0),c&&c.length&&(h=c.children(".jstree-anchor")),o=r.type,d=this.get_icon(r),r.type=i,(d===!0||n[o]&&n[o].icon!==t&&d===n[o].icon)&&this.set_icon(r,n[i].icon===t||n[i].icon),n[o].li_attr!==t&&"object"==typeof n[o].li_attr)for(l in n[o].li_attr)if(n[o].li_attr.hasOwnProperty(l)){if("id"===l)continue;"class"===l?(u[r.id].li_attr["class"]=(u[r.id].li_attr["class"]||"").replace(n[o].li_attr[l],""),c&&c.removeClass(n[o].li_attr[l])):u[r.id].li_attr[l]===n[o].li_attr[l]&&(u[r.id].li_attr[l]=null,c&&c.removeAttr(l))}if(n[o].a_attr!==t&&"object"==typeof n[o].a_attr)for(l in n[o].a_attr)if(n[o].a_attr.hasOwnProperty(l)){if("id"===l)continue;"class"===l?(u[r.id].a_attr["class"]=(u[r.id].a_attr["class"]||"").replace(n[o].a_attr[l],""),h&&h.removeClass(n[o].a_attr[l])):u[r.id].a_attr[l]===n[o].a_attr[l]&&("href"===l?(u[r.id].a_attr[l]="#",h&&h.attr("href","#")):(delete u[r.id].a_attr[l],h&&h.removeAttr(l)))}if(n[i].li_attr!==t&&"object"==typeof n[i].li_attr)for(l in n[i].li_attr)if(n[i].li_attr.hasOwnProperty(l)){if("id"===l)continue;u[r.id].li_attr[l]===t?(u[r.id].li_attr[l]=n[i].li_attr[l],c&&("class"===l?c.addClass(n[i].li_attr[l]):c.attr(l,n[i].li_attr[l]))):"class"===l&&(u[r.id].li_attr["class"]=n[i].li_attr[l]+" "+u[r.id].li_attr["class"],c&&c.addClass(n[i].li_attr[l]))}if(n[i].a_attr!==t&&"object"==typeof n[i].a_attr)for(l in n[i].a_attr)if(n[i].a_attr.hasOwnProperty(l)){if("id"===l)continue;u[r.id].a_attr[l]===t?(u[r.id].a_attr[l]=n[i].a_attr[l],h&&("class"===l?h.addClass(n[i].a_attr[l]):h.attr(l,n[i].a_attr[l]))):"href"===l&&"#"===u[r.id].a_attr[l]?(u[r.id].a_attr.href=n[i].a_attr.href,h&&h.attr("href",n[i].a_attr.href)):"class"===l&&(u[r.id].a_attr["class"]=n[i].a_attr["class"]+" "+u[r.id].a_attr["class"],h&&h.addClass(n[i].a_attr[l]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(r,i){this.check=function(t,r,n,s,a){if(i.check.call(this,t,r,n,s,a)===!1)return!1;if(r=r&&r.id?r:this.get_node(r),n=n&&n.id?n:this.get_node(n),!n||!n.children)return!0;var o,d,l="rename_node"===t?s:r.text,c=[],h=this.settings.unique.case_sensitive,u=this._model.data;for(o=0,d=n.children.length;o<d;o++)c.push(h?u[n.children[o]].text:u[n.children[o]].text.toLowerCase());switch(h||(l=l.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return o=e.inArray(l,c)===-1||r.text&&r.text[h?"toString":"toLowerCase"]()===l,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o;case"create_node":return o=e.inArray(l,c)===-1,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o;case"copy_node":return o=e.inArray(l,c)===-1,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o;case"move_node":return o=r.parent===n.id&&(!a||!a.is_multi)||e.inArray(l,c)===-1,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!r||!r.id)&&r.id,par:!(!n||!n.id)&&n.id})}),o}return!0},this.create_node=function(r,n,s,a,o){if(!n||n.text===t){if(null===r&&(r=e.jstree.root),r=this.get_node(r),!r)return i.create_node.call(this,r,n,s,a,o);if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return i.create_node.call(this,r,n,s,a,o);n||(n={});var d,l,c,h,u,_=this._model.data,f=this.settings.unique.case_sensitive,p=this.settings.unique.duplicate;for(l=d=this.get_string("New node"),c=[],h=0,u=r.children.length;h<u;h++)c.push(f?_[r.children[h]].text:_[r.children[h]].text.toLowerCase());for(h=1;e.inArray(f?l:l.toLowerCase(),c)!==-1;)l=p.call(this,d,++h).toString();n.text=l}return i.create_node.call(this,r,n,s,a,o)}};var g=c.createElement("DIV");if(g.setAttribute("unselectable","on"),g.setAttribute("role","presentation"),g.className="jstree-wholerow",g.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var r,i,n=!1;for(r=0,i=t.selected.length;r<i;r++)n=this.get_node(t.selected[r],!0),n&&n.length&&n.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var r=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),r.teardown.call(this)},this.redraw_node=function(t,i,n,s){if(t=r.redraw_node.apply(this,arguments)){var a=g.cloneNode(!0);e.inArray(t.id,this._data.core.selected)!==-1&&(a.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(a.className+=" jstree-wholerow-hovered"),t.insertBefore(a,t.childNodes[0])}return t}},c.registerElement&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var t,r={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(r.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(r[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(r.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(r);
};try{c.registerElement("vakata-jstree",{prototype:m})}catch(v){}}}}),function(e){function t(){for(var e=new Date(this.toString()),t=28,r=e.getMonth();e.getMonth()==r;)++t,e.setDate(t);return t-1}e.addDays=function(e){this.setDate(this.getDate()+e)},e.addMonths=function(e){var r=this.getDate();this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(r,t.apply(this)))},e.addYears=function(e){var r=this.getDate();this.setDate(1),this.setFullYear(this.getFullYear()+e),this.setDate(Math.min(r,t.apply(this)))},e.getDayOfYear=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),t=new Date(this.getFullYear(),0,0,0,0,0),r=e-t;return Math.floor(r/24*60*60*1e3)}}(Date.prototype),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e,t){e=e.split(" ");for(var r=0;r<e.length;++r)e[r]+=t;return e.join(" ")}function r(){var t,r,i,s,a,o,d,l=e(this).data("pickmeup-options"),c=this.pickmeup,h=Math.floor(l.calendars/2),u=l.date,_=l.current,f=l.min?new Date(l.min):null,p=l.max?new Date(l.max):null,g=(new Date).setHours(0,0,0,0).valueOf();f&&(f.setDate(1),f.addMonths(1),f.addDays(-1)),p&&(p.setDate(1),p.addMonths(1),p.addDays(-1)),c.find(".pmu-instance > :not(nav)").remove();for(var m=0;m<l.calendars;m++)if(t=new Date(_),s=c.find(".pmu-instance").eq(m),c.hasClass("pmu-view-years")?(t.addYears(12*(m-h)),r=t.getFullYear()-6+" - "+(t.getFullYear()+5)):c.hasClass("pmu-view-months")?(t.addYears(m-h),r=t.getFullYear()):c.hasClass("pmu-view-days")&&(t.addMonths(m-h),r=n(t,l.title_format,l.locale)),!o&&p&&(d=new Date(t),l.select_day?d.addMonths(l.calendars-1):l.select_month?d.addYears(l.calendars-1):d.addYears(12*(l.calendars-1)),d>p))--m,_.addMonths(-1),o=void 0;else if(o=new Date(t),!a&&(a=new Date(t),a.setDate(1),a.addMonths(1),a.addDays(-1),f&&f>a))--m,_.addMonths(1),a=void 0;else{s.find(".pmu-month").text(r),i="";var v=function(e){return"range"==l.mode&&e>=new Date(u[0]).getFullYear()&&e<=new Date(u[1]).getFullYear()||"multiple"==l.mode&&u.reduce(function(e,t){return e.push(new Date(t).getFullYear()),e},[]).indexOf(e)!==-1||new Date(u).getFullYear()==e},b=function(e,t){var r=new Date(u[0]).getFullYear(),i=new Date(u[1]).getFullYear(),n=new Date(u[0]).getMonth(),s=new Date(u[1]).getMonth();return"range"==l.mode&&e>r&&e<i||"range"==l.mode&&e==r&&e<i&&t>=n||"range"==l.mode&&e>r&&e==i&&t<=s||"range"==l.mode&&e==r&&e==i&&t>=n&&t<=s||"multiple"==l.mode&&u.reduce(function(e,t){return t=new Date(t),e.push(t.getFullYear()+"-"+t.getMonth()),e},[]).indexOf(e+"-"+t)!==-1||new Date(u).getFullYear()==e&&new Date(u).getMonth()==t};!function(){for(var e,r=[],n=t.getFullYear()-6,s=new Date(l.min).getFullYear(),a=new Date(l.max).getFullYear(),o=0;o<12;++o)e={text:n+o,class_name:[]},l.min&&e.text<s||l.max&&e.text>a?e.class_name.push("pmu-disabled"):v(e.text)&&e.class_name.push("pmu-selected"),e.class_name=e.class_name.join(" "),r.push(e);i+=y.body(r,"pmu-years")}(),function(){for(var e,r=[],n=t.getFullYear(),s=new Date(l.min).getFullYear(),a=new Date(l.min).getMonth(),o=new Date(l.max).getFullYear(),d=new Date(l.max).getMonth(),c=0;c<12;++c)e={text:l.locale.monthsShort[c],class_name:[]},l.min&&(n<s||c<a&&n==s)||l.max&&(n>o||c>d&&n>=o)?e.class_name.push("pmu-disabled"):b(n,c)&&e.class_name.push("pmu-selected"),e.class_name=e.class_name.join(" "),r.push(e);i+=y.body(r,"pmu-months")}(),function(){var r,n=[],s=t.getMonth();!function(){t.setDate(1);var e=(t.getDay()-l.first_day)%7;t.addDays(-(e+(e<0?7:0)))}();for(var a=0;a<42;++a){r={text:t.getDate(),class_name:[]},s!=t.getMonth()&&r.class_name.push("pmu-not-in-month"),0==t.getDay()?r.class_name.push("pmu-sunday"):6==t.getDay()&&r.class_name.push("pmu-saturday");var o=l.render(new Date(t))||{},d=t.valueOf(),c=l.min&&l.min>t||l.max&&l.max<t;o.disabled||c?r.class_name.push("pmu-disabled"):(o.selected||l.date==d||e.inArray(d,l.date)!==-1||"range"==l.mode&&d>=l.date[0]&&d<=l.date[1])&&r.class_name.push("pmu-selected"),d==g&&r.class_name.push("pmu-today"),o.class_name&&r.class_name.push(o.class_name),r.class_name=r.class_name.join(" "),n.push(r),t.addDays(1)}i+=y.body(n,"pmu-days")}(),s.append(i)}a.setDate(1),o.setDate(1),o.addMonths(1),o.addDays(-1),c.find(".pmu-prev").css("visibility",l.min&&l.min>=a?"hidden":"visible"),c.find(".pmu-next").css("visibility",l.max&&l.max<=o?"hidden":"visible"),l.fill.apply(this)}function i(t,r,n,s){if(t.constructor==Date)return t;if(!t)return new Date;var a=t.split(n);if(a.length>1)return a.forEach(function(t,a,o){o[a]=i(e.trim(t),r,n,s)}),a;var o=s.monthsShort.join(")(")+")("+s.months.join(")(");n=new RegExp("[^0-9a-zA-Z("+o+")]+");for(var d,l,c,h,u,_=t.split(n),f=r.split(n),p=new Date,g=0;g<_.length;g++)switch(f[g]){case"b":l=s.monthsShort.indexOf(_[g]);break;case"B":l=s.months.indexOf(_[g]);break;case"d":case"e":d=parseInt(_[g],10);break;case"m":l=parseInt(_[g],10)-1;break;case"Y":case"y":c=parseInt(_[g],10),c+=c>100?0:c<29?2e3:1900;break;case"H":case"I":case"k":case"l":h=parseInt(_[g],10);break;case"P":case"p":/pm/i.test(_[g])&&h<12?h+=12:/am/i.test(_[g])&&h>=12&&(h-=12);break;case"M":u=parseInt(_[g],10)}var m=new Date(void 0===c?p.getFullYear():c,void 0===l?p.getMonth():l,void 0===d?p.getDate():d,void 0===h?p.getHours():h,void 0===u?p.getMinutes():u,0);return isNaN(1*m)&&(m=new Date),m}function n(e,t,r){var i=e.getMonth(),n=e.getDate(),s=e.getFullYear(),a=e.getDay(),o=e.getHours(),d=o>=12,l=d?o-12:o,c=e.getDayOfYear();0==l&&(l=12);for(var h,u=e.getMinutes(),_=e.getSeconds(),f=t.split(""),p=0;p<f.length;p++){switch(h=f[p]){case"a":h=r.daysShort[a];break;case"A":h=r.days[a];break;case"b":h=r.monthsShort[i];break;case"B":h=r.months[i];break;case"C":h=1+Math.floor(s/100);break;case"d":h=n<10?"0"+n:n;break;case"e":h=n;break;case"H":h=o<10?"0"+o:o;break;case"I":h=l<10?"0"+l:l;break;case"j":h=c<100?c<10?"00"+c:"0"+c:c;break;case"k":h=o;break;case"l":h=l;break;case"m":h=i<9?"0"+(1+i):1+i;break;case"M":h=u<10?"0"+u:u;break;case"p":case"P":h=d?"PM":"AM";break;case"s":h=Math.floor(e.getTime()/1e3);break;case"S":h=_<10?"0"+_:_;break;case"u":h=a+1;break;case"w":h=a;break;case"y":h=(""+s).substr(2,2);break;case"Y":h=s}f[p]=h}return f.join("")}function s(){var t,r=e(this),i=r.data("pickmeup-options"),n=i.current;switch(i.mode){case"multiple":t=n.setHours(0,0,0,0).valueOf(),e.inArray(t,i.date)!==-1?e.each(i.date,function(e,r){return r!=t||(i.date.splice(e,1),!1)}):i.date.push(t);break;case"range":i.lastSel||(i.date[0]=n.setHours(0,0,0,0).valueOf()),t=n.setHours(0,0,0,0).valueOf(),t<=i.date[0]?(i.date[1]=i.date[0],i.date[0]=t):i.date[1]=t,i.lastSel=!i.lastSel;break;default:i.date=n.valueOf()}var s=o(i);if(r.is("input")&&r.val("single"==i.mode?s[0]:s[0].join(i.separator)),i.change.apply(this,s),!i.flat&&i.hide_on_select&&("range"!=i.mode||!i.lastSel))return i.binded.hide(),!1}function a(t){var r=e(t.target);if(r.hasClass("pmu-button")||(r=r.closest(".pmu-button")),r.length){if(r.hasClass("pmu-disabled"))return!1;var i=e(this),n=i.data("pickmeup-options"),s=r.parents(".pmu-instance").eq(0),a=s.parent(),o=e(".pmu-instance",a).index(s);if(r.parent().is("nav"))r.hasClass("pmu-month")?(n.current.addMonths(o-Math.floor(n.calendars/2)),a.hasClass("pmu-view-years")?("single"!=n.mode?n.current=new Date(n.date[n.date.length-1]):n.current=new Date(n.date),n.select_day?a.removeClass("pmu-view-years").addClass("pmu-view-days"):n.select_month&&a.removeClass("pmu-view-years").addClass("pmu-view-months")):a.hasClass("pmu-view-months")?n.select_year?a.removeClass("pmu-view-months").addClass("pmu-view-years"):n.select_day&&a.removeClass("pmu-view-months").addClass("pmu-view-days"):a.hasClass("pmu-view-days")&&(n.select_month?a.removeClass("pmu-view-days").addClass("pmu-view-months"):n.select_year&&a.removeClass("pmu-view-days").addClass("pmu-view-years"))):r.hasClass("pmu-prev")?n.binded.prev(!1):n.binded.next(!1);else if(!r.hasClass("pmu-disabled"))if(a.hasClass("pmu-view-years"))n.current.setFullYear(parseInt(r.text(),10)),n.select_month?a.removeClass("pmu-view-years").addClass("pmu-view-months"):n.select_day?a.removeClass("pmu-view-years").addClass("pmu-view-days"):n.binded.update_date();else if(a.hasClass("pmu-view-months"))n.current.setMonth(s.find(".pmu-months .pmu-button").index(r)),n.current.setFullYear(parseInt(s.find(".pmu-month").text(),10)),n.select_day?a.removeClass("pmu-view-months").addClass("pmu-view-days"):n.binded.update_date(),n.current.addMonths(Math.floor(n.calendars/2)-o);else{var d=parseInt(r.text(),10);n.current.addMonths(o-Math.floor(n.calendars/2)),r.hasClass("pmu-not-in-month")&&n.current.addMonths(d>15?-1:1),n.current.setDate(d),n.binded.update_date()}n.binded.fill()}return!1}function o(t){var r;return"single"==t.mode?(r=new Date(t.date),[n(r,t.format,t.locale),r]):(r=[[],[]],e.each(t.date,function(e,i){var s=new Date(i);r[0].push(n(s,t.format,t.locale)),r[1].push(s)}),r)}function d(r){var n=this.pickmeup;if(r||!n.is(":visible")){var s=e(this),a=s.data("pickmeup-options"),o=s.offset(),d={l:document.documentElement.scrollLeft,t:document.documentElement.scrollTop,w:document.documentElement.clientWidth,h:document.documentElement.clientHeight},l=o.top,c=o.left;if(a.binded.fill(),s.is("input")&&(s.keydown(function(e){e.stopPropagation(),9==e.which&&s.pickmeup("hide")}).blur(function(){""!==s.val()&&(s.pickmeup("set_date",i(s.val(),a.format,a.separator,a.locale)),a.binded.update_date())}),a.lastSel=!1),a.before_show(),0==a.show())return;if(!a.flat){switch(a.position){case"top":l-=n.outerHeight();break;case"left":c-=n.outerWidth();break;case"right":c+=this.offsetWidth;break;case"bottom":l+=this.offsetHeight}l+n.offsetHeight>d.t+d.h&&(l=o.top-n.offsetHeight),l<d.t&&(l=o.top+this.offsetHeight+n.offsetHeight),c+n.offsetWidth>d.l+d.w&&(c=o.left-n.offsetWidth),c<d.l&&(c=o.left+this.offsetWidth),n.css({display:"inline-block",top:l+"px",left:c+"px"}),e(document).on(t(a.trigger_event,a.events_namespace),a.binded.hide).on("resize"+a.events_namespace,[!0],a.binded.forced_show)}}}function l(){d.call(this,!0)}function c(r){if(!r||!r.target||r.target!=this&&!(16&this.pickmeup.get(0).compareDocumentPosition(r.target))){var i=this.pickmeup,n=e(this).data("pickmeup-options");0!=n.hide()&&(i.hide(),e(document).off(t(n.trigger_event,n.events_namespace),n.binded.hide).off("resize",n.binded.forced_show),n.lastSel=!1)}}function h(){var r=e(this).data("pickmeup-options");e(document).off(t(r.trigger_event,r.events_namespace),r.binded.hide).off("resize",r.binded.forced_show),r.binded.forced_show()}function u(){var t=e(this).data("pickmeup-options");"single"!=t.mode&&(t.date=[],t.lastSel=!1,t.binded.fill())}function _(t){"undefined"==typeof t&&(t=!0);var r=this.pickmeup,i=e(this).data("pickmeup-options");r.hasClass("pmu-view-years")?i.current.addYears(-12):r.hasClass("pmu-view-months")?i.current.addYears(-1):r.hasClass("pmu-view-days")&&i.current.addMonths(-1),t&&i.binded.fill()}function f(t){"undefined"==typeof t&&(t=!0);var r=this.pickmeup,i=e(this).data("pickmeup-options");r.hasClass("pmu-view-years")?i.current.addYears(12):r.hasClass("pmu-view-months")?i.current.addYears(1):r.hasClass("pmu-view-days")&&i.current.addMonths(1),t&&i.binded.fill()}function p(t){var r=e(this).data("pickmeup-options"),i=o(r);if("string"==typeof t){var s=i[1];return s.constructor==Date?n(s,t,r.locale):s.map(function(e){return n(e,t,r.locale)})}return i[t?0:1]}function g(t){var r=e(this),n=r.data("pickmeup-options");if(n.date=t,"string"==typeof n.date?n.date=i(n.date,n.format,n.separator,n.locale).setHours(0,0,0,0):n.date.constructor==Date&&n.date.setHours(0,0,0,0),n.date||(n.date=new Date,n.date.setHours(0,0,0,0)),"single"!=n.mode)if(n.date.constructor!=Array)n.date=[n.date.valueOf()],"range"==n.mode&&n.date.push(new Date(n.date[0]).setHours(0,0,0,0).valueOf());else{for(var s=0;s<n.date.length;s++)n.date[s]=i(n.date[s],n.format,n.separator,n.locale).setHours(0,0,0,0).valueOf();"range"==n.mode&&(n.date[1]=new Date(n.date[1]).setHours(0,0,0,0).valueOf())}else(r.val()||n.default_date!==!1)&&(n.date=n.date.constructor==Array?n.date[0].valueOf():n.date.valueOf());if(n.current=new Date("single"!=n.mode?n.date[0]:n.date),n.binded.fill(),r.is("input")&&n.default_date!==!1){var a=o(n);r.val()||n.change.apply(this,a),r.val("single"==n.mode?a[0]:a[0].join(n.separator))}}function m(){var t=e(this),r=t.data("pickmeup-options");t.removeData("pickmeup-options"),t.off(r.events_namespace),e(document).off(r.events_namespace),e(this.pickmeup).remove()}var v=0;e.pickmeup=e.extend(e.pickmeup||{},{date:new Date,default_date:new Date,flat:!1,first_day:1,prev:"&#9664;",next:"&#9654;",mode:"single",select_year:!0,select_month:!0,select_day:!0,view:"days",calendars:1,format:"d-m-Y",title_format:"B, Y",position:"bottom",trigger_event:"click touchstart",class_name:"",separator:" - ",hide_on_select:!1,min:null,max:null,render:function(){},change:function(){return!0},before_show:function(){return!0},show:function(){return!0},hide:function(){return!0},fill:function(){return!0},locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}});var b={years:"pmu-view-years",months:"pmu-view-months",days:"pmu-view-days"},y={wrapper:'<div class="pickmeup" />',head:function(e){for(var t="",r=0;r<7;++r)t+="<div>"+e.day[r]+"</div>";return'<div class="pmu-instance"><nav><div class="pmu-prev pmu-button">'+e.prev+'</div><div class="pmu-month pmu-button" /><div class="pmu-next pmu-button">'+e.next+'</div></nav><nav class="pmu-day-of-week">'+t+"</nav></div>"},body:function(e,t){for(var r="",i=0;i<e.length;++i)r+='<div class="'+e[i].class_name+' pmu-button">'+e[i].text+"</div>";return'<div class="'+t+'">'+r+"</div>"}};e.fn.pickmeup=function(n){if("string"==typeof n){var o,j=Array.prototype.slice.call(arguments,1);switch(n){case"hide":case"show":case"clear":case"update":case"prev":case"next":case"destroy":this.each(function(){o=e(this).data("pickmeup-options"),o&&o.binded[n]()});break;case"get_date":return o=this.data("pickmeup-options"),o?o.binded.get_date(j[0]):null;case"set_date":this.each(function(){o=e(this).data("pickmeup-options"),o&&o.binded[n].apply(this,j)})}return this}return this.each(function(){var o=e(this);if(!o.data("pickmeup-options")){var j,k,x=e.extend({},e.pickmeup,n||{});for(j in x)k=o.data("pmu-"+j),"undefined"!=typeof k&&(x[j]=k);if("days"!=x.view||x.select_day||(x.view="months"),"months"!=x.view||x.select_month||(x.view="years"),"years"!=x.view||x.select_year||(x.view="days"),"days"!=x.view||x.select_day||(x.view="months"),x.calendars=Math.max(1,parseInt(x.calendars,10)||1),x.mode=/single|multiple|range/.test(x.mode)?x.mode:"single","string"==typeof x.min?x.min=i(x.min,x.format,x.separator,x.locale).setHours(0,0,0,0):x.min&&x.min.constructor==Date&&x.min.setHours(0,0,0,0),"string"==typeof x.max?x.max=i(x.max,x.format,x.separator,x.locale).setHours(0,0,0,0):x.max&&x.max.constructor==Date&&x.max.setHours(0,0,0,0),x.select_day||(x.min&&(x.min=new Date(x.min),x.min.setDate(1),x.min=x.min.valueOf()),x.max&&(x.max=new Date(x.max),x.max.setDate(1),x.max=x.max.valueOf())),"string"==typeof x.date?x.date=i(x.date,x.format,x.separator,x.locale).setHours(0,0,0,0):x.date.constructor==Date&&x.date.setHours(0,0,0,0),x.date||(x.date=new Date,x.date.setHours(0,0,0,0)),"single"!=x.mode){if(x.date.constructor!=Array)x.date=[x.date.valueOf()],"range"==x.mode&&x.date.push(new Date(x.date[0]).setHours(0,0,0,0).valueOf());else{for(j=0;j<x.date.length;j++)x.date[j]=i(x.date[j],x.format,x.separator,x.locale).setHours(0,0,0,0).valueOf();"range"==x.mode&&(x.date[1]=new Date(x.date[1]).setHours(0,0,0,0).valueOf())}if(x.current=new Date(x.date[x.date.length-1]),!x.select_day)for(j=0;j<x.date.length;++j)x.date[j]=new Date(x.date[j]),x.date[j].setDate(1),x.date[j]=x.date[j].valueOf(),"range"!=x.mode&&x.date.indexOf(x.date[j])!==j&&(delete x.date.splice(j,1),--j)}else x.date=x.date.valueOf(),x.current=new Date(x.date),x.select_day||(x.date=new Date(x.date),x.date.setDate(1),x.date=x.date.valueOf());x.current.setDate(1),x.current.setHours(0,0,0,0);var w,C=e(y.wrapper);this.pickmeup=C,x.class_name&&C.addClass(x.class_name);var T="";for(j=0;j<x.calendars;j++)w=x.first_day,T+=y.head({prev:x.prev,next:x.next,day:[x.locale.daysMin[w++%7],x.locale.daysMin[w++%7],x.locale.daysMin[w++%7],x.locale.daysMin[w++%7],x.locale.daysMin[w++%7],x.locale.daysMin[w++%7],x.locale.daysMin[w++%7]]});o.data("pickmeup-options",x);for(j in x)["render","before_show","show","hide"].indexOf(j)!=-1&&(x[j]=x[j].bind(this));x.binded={fill:r.bind(this),update_date:s.bind(this),click:a.bind(this),show:d.bind(this),forced_show:l.bind(this),hide:c.bind(this),update:h.bind(this),clear:u.bind(this),prev:_.bind(this),next:f.bind(this),get_date:p.bind(this),set_date:g.bind(this),destroy:m.bind(this)},x.events_namespace=".pickmeup-"+ ++v,C.on(t(x.trigger_event,x.events_namespace),x.binded.click).addClass(b[x.view]).append(T).on(e.support.selectstart?"selectstart":"mousedown",function(e){e.preventDefault()}),x.binded.fill(),x.flat?C.appendTo(this).css({position:"relative",display:"inline-block"}):(C.appendTo(document.body),o.on(t(x.trigger_event,x.events_namespace),x.binded.show))}})}});
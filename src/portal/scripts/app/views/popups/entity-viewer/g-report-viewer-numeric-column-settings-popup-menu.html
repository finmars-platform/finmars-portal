<div class="popup-menu">

    <div ng-if="popupData.data.column.groups"
         ng-include="'views/popups/entity-viewer/g-rv-group-settings-menu-options.html'"></div>

    <div data-ng-if="!popupData.data.columnHasCorrespondingGroup(popupData.data.column.key)">
        <md-button data-ng-click="popupData.data.addColumnEntityToGrouping(popupData.data.column)"
                   class="popup-menu-item">
            <ng-md-icon icon="visibility_off"
                        style="visibility: hidden;"></ng-md-icon>
            <span>Add to grouping</span>
        </md-button>
    </div>

    <div>
        <md-button data-ng-disabled="!popupData.data.checkForFilteringBySameAttr(popupData.data.column.key) || popupData.data.viewContext === 'dashboard'"
                   data-ng-click="popupData.data.addFiltersWithColAttr(popupData.data.column)"
                   class="popup-menu-item">
            <ng-md-icon icon="visibility_off"
                        style="visibility: hidden;"></ng-md-icon>
            <span>Add to Filters</span>
        </md-button>
    </div>

    <div>

        <md-button class="popup-menu-item" aria-label="show number formatting menu"
                   popup
                   popup-template-url="'views/popups/entity-viewer/g-report-viewer-number-format-popup-menu.html'"
                   open-on="mouse_over"
                   close-on-click-outside="true"
                   close-on-mouse-leave="true"
                   prevent-default="true"
                   popup-data="popupData"
                   position-relative-to="element"
                   relative-popup-x="right"
                   relative-popup-y="top"
                   popup-classes="'g-column-context-menu-submenu-popup'"
                   backdrop-classes="'low-z-index-backdrop'"
                   popup-event-service="popupEventService">

            <ng-md-icon icon="done"
                        class="z-menu-icon"
                        style="visibility: hidden;"></ng-md-icon>
            <span>Number Format</span>
            <ng-md-icon icon="arrow_drop_up"
                        class="z-dropdown-icon"></ng-md-icon>
        </md-button>

    </div>

    <div data-ng-if="popupData.data.$index !== 0">
        <md-button ng-click="popupData.data.selectSubtotalType(popupData.data.column, 1)"
                   class="popup-menu-item">
            <ng-md-icon icon="done"
                        data-ng-show="!popupData.data.checkSubtotalFormula(popupData.data.column, 1)"
                        class="z-menu-icon"
                        style="visibility: hidden;"></ng-md-icon>
            <ng-md-icon icon="done"
                        data-ng-show="popupData.data.checkSubtotalFormula(popupData.data.column, 1)"
                        class="z-menu-icon"></ng-md-icon>
            <span>Subtotal SUM</span>
        </md-button>
    </div>

    <div data-ng-if="popupData.data.$index !== 0 && !popupData.data.isSubtotalWeightedShouldBeExcluded(popupData.data.column)">

        <md-button aria-label="Open phone interactions menu"
                   class="popup-menu-item"
                   popup
                   popup-template-url="'views/popups/entity-viewer/g-report-viewer-subtotal-weighted-popup-menu.html'"
                   open-on="mouse_over"
                   close-on-click-outside="true"
                   close-on-mouse-leave="true"
                   prevent-default="true"
                   popup-data="popupData"
                   position-relative-to="element"
                   relative-popup-x="right"
                   relative-popup-y="top"
                   popup-classes="'g-column-context-menu-submenu-popup'"
                   backdrop-classes="'low-z-index-backdrop'"
                   popup-event-service="popupEventService">

                <ng-md-icon icon="done"
                            class="z-menu-icon"
                            style="visibility: hidden;"></ng-md-icon>
                <span>Subtotal Weighted</span>
                <ng-md-icon icon="arrow_drop_up"
                            class="z-dropdown-icon"></ng-md-icon>
            </md-button>

    </div>

    <div data-ng-if="popupData.data.$index !== 0 && !popupData.data.isSubtotalWeightedShouldBeExcluded(popupData.data.column)">

        <md-button aria-label="Open phone interactions menu"
                   class="popup-menu-item"
                   popup
                   popup-template-url="'views/popups/entity-viewer/g-report-viewer-subtotal-avg-weighted-popup-menu.html'"
                   open-on="mouse_over"
                   close-on-click-outside="true"
                   close-on-mouse-leave="true"
                   prevent-default="'true'"
                   popup-data="popupData"
                   position-relative-to="element"
                   relative-popup-x="right"
                   relative-popup-y="top"
                   popup-classes="'g-column-context-menu-submenu-popup'"
                   backdrop-classes="'low-z-index-backdrop'"
                   popup-event-service="popupEventService">
            <ng-md-icon icon="done"
                        class="z-menu-icon"
                        style="visibility: hidden;"></ng-md-icon>
            <span>Subtotal Avg. Weighted</span>
            <ng-md-icon icon="arrow_drop_up"
                        class="z-dropdown-icon"></ng-md-icon>
        </md-button>

    </div>

    <div>
        <md-button ng-click="popupData.data.reportHideSubtotal(popupData.data.column)"
                   class="popup-menu-item">
            <ng-md-icon icon="done" style="visibility: hidden;"></ng-md-icon>
            <span data-ng-show="!popupData.data.column.report_settings.hide_subtotal">Hide subtotal</span>
            <span data-ng-show="popupData.data.column.report_settings.hide_subtotal">Show subtotal</span>
        </md-button>
    </div>

    <div>
        <md-button ng-click="popupData.data.resizeColumn(popupData.data.column, $mdMenu, $event)"
                   class="popup-menu-item">
            <ng-md-icon icon="visibility_off"
                        style="visibility: hidden;"></ng-md-icon>
            <span>Resize</span>
        </md-button>
    </div>

    <md-menu-divider data-ng-if="!popupData.data.isReport || !popupData.data.columnHasCorrespondingGroup(popupData.data.column.key)"></md-menu-divider>

    <div data-ng-if="!popupData.data.isReport || !popupData.data.columnHasCorrespondingGroup(popupData.data.column.key)">

        <md-button class="md-icon-button align-button rounded"
                   data-ng-class="{active: popupData.data.checkColTextAlign(popupData.data.column, 'left')}"
                   ng-click="popupData.data.changeColumnTextAlign(popupData.data.column, 'left')">
            <span class="material-icons">format_align_left</span>
            <md-tooltip md-direction="top">Left alignment</md-tooltip>
        </md-button>

        <md-button class="md-icon-button align-button rounded"
                   data-ng-class="{active: popupData.data.checkColTextAlign(popupData.data.column, 'center')}"
                   ng-click="popupData.data.changeColumnTextAlign(popupData.data.column, 'center')">
            <span class="material-icons">format_align_center</span>
            <md-tooltip md-direction="top">Center alignment</md-tooltip>
        </md-button>

        <md-button class="md-icon-button align-button rounded"
                   data-ng-class="{active: popupData.data.checkColTextAlign(popupData.data.column, 'right')}"
                   ng-click="popupData.data.changeColumnTextAlign(popupData.data.column, 'right')">
            <span class="material-icons">format_align_right</span>
            <md-tooltip md-direction="top">Right alignment</md-tooltip>
        </md-button>

    </div>

    <md-menu-divider data-ng-if="!popupData.data.isReport || !popupData.data.columnHasCorrespondingGroup(popupData.data.column.key)"></md-menu-divider>

    <div data-ng-if="!popupData.data.isReport || popupData.data.columnHasCorrespondingGroup(popupData.data.column.key)">
        <md-button ng-click="popupData.data.removeGroup(popupData.data.column.___column_id || popupData.data.column.___group_type_id)"
                   class="popup-menu-item">
            <ng-md-icon icon="visibility_off"></ng-md-icon>
            <span>Remove</span>
        </md-button>
    </div>

    <div data-ng-if="!popupData.data.isReport || !popupData.data.columnHasCorrespondingGroup(popupData.data.column.key)">
        <md-button ng-click="popupData.data.removeColumn(popupData.data.column)"
                   class="popup-menu-item">
            <ng-md-icon icon="visibility_off"></ng-md-icon>
            <span>Remove</span>
        </md-button>
    </div>

</div>

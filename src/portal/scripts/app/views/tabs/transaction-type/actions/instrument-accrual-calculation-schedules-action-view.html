<div layout="row">
    <md-input-container>
        <label for="" class="uncut-text-on-focus-label" content-title>Rebook reaction / Create if exists reactions</label>
        <md-select data-ng-model="item.rebook_reaction">
            <md-option data-ng-repeat="item in vm.rebookOtherReactions"
                       ng-value="item.id">
                {{item.name}}
            </md-option>
        </md-select>
    </md-input-container>
</div>
<div layout="row">
    <div flex="50">
        <div layout="row">
            <div flex="50">
                <div layout="row">
                    <div flex="20">
                        <md-button
                                class="md-icon-button md-raised {{!!item.instrument_accrual_calculation_schedules.instrument_toggle ? 'ref' : ''}}"
                                style="transform: scale(0.7,0.7)"
                                data-ng-click="vm.resetPropertyBtn(item, 'instrument_accrual_calculation_schedules', 'instrument')">
                            <span data-ng-if="!!item.instrument_accrual_calculation_schedules.instrument_toggle">R</span>
                            <span data-ng-if="!!!item.instrument_accrual_calculation_schedules.instrument_toggle">I</span>
                        </md-button>
                    </div>
                    <div flex="80">
                        <div data-ng-if="item.instrument_accrual_calculation_schedules.instrument_toggle">
                            <entity-search-select data-item="item.instrument_accrual_calculation_schedules.instrument"
                                                  data-label="'Instrument'"
                                                  data-input-text="item.instrument_accrual_calculation_schedules.instrument_object.name"
                                                  data-entity-type="'instrument'"></entity-search-select>
                        </div>
                        <div data-ng-if="!item.instrument_accrual_calculation_schedules.instrument_toggle">
                            <md-input-container>
                                <label for="" content-title>Instrument</label>
                                <md-select
                                        data-ng-model="item.instrument_accrual_calculation_schedules[vm.resolveInstrumentProp(item, 'instrument_accrual_calculation_schedules', 'instrument')]">
                                    <md-optgroup label="Inputs">
                                        <md-option
                                                data-ng-click="vm.setItemInstrumentInput(item, 'instrument_accrual_calculation_schedules', inputItem.name, 'instrument')"
                                                data-ng-repeat="inputItem in vm.findInputs('instrument')"
                                                ng-value="inputItem.name">
                                            {{inputItem.name}}
                                        </md-option>
                                    </md-optgroup>
                                    <md-optgroup label="Phantoms">
                                        <md-option
                                                data-ng-click="vm.setItemInstrumentPhantom(item, 'instrument_accrual_calculation_schedules', phantomItem.positionOrder, 'instrument')"
                                                data-ng-repeat="phantomItem in vm.findPhantoms()"
                                                ng-value="phantomItem.positionOrder">
                                            {{phantomItem.action_notes}}
                                        </md-option>
                                    </md-optgroup>
                                </md-select>
                            </md-input-container>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div layout="row">
            <div flex="33">
                <md-input-container class="expression-input-container">
                    <label for="" class="uncut-text-on-focus-label" content-title>Accrual start date: Date</label>
                    <input type="text" value-title data-ng-model="item.instrument_accrual_calculation_schedules.accrual_start_date">
                </md-input-container>
                <expression-editor-button data-data="{groups: [vm.inputsGroup], functions: [vm.inputsFunctions]}"
                        data-item="item.instrument_accrual_calculation_schedules.accrual_start_date"></expression-editor-button>
            </div>
            <div flex="33">
                <md-input-container class="expression-input-container">
                    <label for="" class="uncut-text-on-focus-label" content-title>First payment date: Date</label>
                    <input type="text" value-title data-ng-model="item.instrument_accrual_calculation_schedules.first_payment_date">
                </md-input-container>
                <expression-editor-button data-data="{groups: [vm.inputsGroup], functions: [vm.inputsFunctions]}"
                        data-item="item.instrument_accrual_calculation_schedules.first_payment_date"></expression-editor-button>
            </div>
            <div flex="33">
                <md-input-container class="expression-input-container">
                    <label for="" class="uncut-text-on-focus-label" content-title>Accrual size: Number</label>
                    <input type="text" value-title data-ng-model="item.instrument_accrual_calculation_schedules.accrual_size">
                </md-input-container>
                <expression-editor-button data-data="{groups: [vm.inputsGroup], functions: [vm.inputsFunctions]}"
                        data-item="item.instrument_accrual_calculation_schedules.accrual_size"></expression-editor-button>
            </div>
        </div>
    </div>
    <div flex="50">
        <div flex="50" layout="row">
            <md-input-container class="expression-input-container">
                <label for="" class="uncut-text-on-focus-label" content-title>Notes: Text</label>
                <input type="text" value-title style="color: grey;"
                       data-ng-model="item.instrument_accrual_calculation_schedules.notes">
            </md-input-container>
            <expression-editor-button data-data="{groups: [vm.inputsGroup], functions: [vm.inputsFunctions]}"
                    data-item="item.instrument_accrual_calculation_schedules.notes"></expression-editor-button>
        </div>
        <div layout="row">
            <div flex="33" layout="row">
                <md-input-container class="expression-input-container">
                    <label for="" class="uncut-text-on-focus-label" content-title>Periodicity n: Number</label>
                    <input type="text" value-title data-ng-model="item.instrument_accrual_calculation_schedules.periodicity_n">
                </md-input-container>
                <expression-editor-button data-data="{groups: [vm.inputsGroup], functions: [vm.inputsFunctions]}"
                        data-item="item.instrument_accrual_calculation_schedules.periodicity_n"></expression-editor-button>
            </div>
            <div flex="33" layout="row">
                <div flex="20">
                    <md-button
                            class="md-icon-button md-raised {{!!item.instrument_accrual_calculation_schedules.periodicity_toggle ? 'ref' : ''}}"
                            style="transform: scale(0.7,0.7)"
                            data-ng-click="vm.resetPropertyBtn(item, 'instrument_accrual_calculation_schedules', 'periodicity')">
                        <span data-ng-if="!!item.instrument_accrual_calculation_schedules.periodicity_toggle">R</span>
                        <span data-ng-if="!!!item.instrument_accrual_calculation_schedules.periodicity_toggle">I</span>
                    </md-button>
                </div>
                <div flex="80">
                    <div data-ng-if="item.instrument_accrual_calculation_schedules.periodicity_toggle">
                        <!--<md-input-container>
                            <label for="" class="uncut-text-on-focus-label" content-title>Periodicity</label>
                            <md-select data-ng-model="item.instrument_accrual_calculation_schedules.periodicity"
                                       md-on-open="vm.loadRelation('periodicity')"
                                       md-container-class="simple-search-select">
                                <md-select-header>
                                    <input data-ng-model="searchTerm"
                                           type="search"
                                           placeholder="Search for a ..."
                                           class="md-text md-select-search-pattern simple-search-filter-input">
                                </md-select-header>
                                <md-option data-ng-repeat="relationItem in vm.relationItems['periodicity'] | filter: {name: searchTerm}"
                                           data-ng-value="relationItem.id"
                                           data-ng-if="vm.relationItems['periodicity'].length">
                                    {{relationItem.name}}
                                </md-option>

                                <md-option
                                        data-ng-if="!vm.relationItems['periodicity'].length"
                                        ng-value="item.instrument_accrual_calculation_schedules.periodicity_object.id">
                                    {{item.instrument_accrual_calculation_schedules.periodicity_object.name}}
                                </md-option>
                            </md-select>
                        </md-input-container>-->

                        <ttype-actions-relations-select
                                label-title="Periodicity"
                                model="item.instrument_accrual_calculation_schedules.periodicity"
                                load-relation="vm.loadRelation('periodicity')"
                                relation-items="vm.relationItems['periodicity']"
                                selected-value="item.instrument_accrual_calculation_schedules.periodicity_object.id"
                                selected-name="item.instrument_accrual_calculation_schedules.periodicity_object.name"></ttype-actions-relations-select>
                    </div>
                    <div data-ng-if="!item.instrument_accrual_calculation_schedules.periodicity_toggle">
                        <!--<md-input-container>
                            <label for="" class="uncut-text-on-focus-label" content-title>Periodicity</label>
                            <md-select
                                    data-ng-model="item.instrument_accrual_calculation_schedules.periodicity_input">
                                <md-option
                                        data-ng-repeat="inputItem in vm.findInputs('periodicity')"
                                        ng-value="inputItem.name">
                                    {{inputItem.name}}
                                </md-option>
                            </md-select>
                        </md-input-container>-->

                        <ttype-actions-input-select label-title="Periodicity"
                                                    model="item.instrument_accrual_calculation_schedules.periodicity_input"
                                                    find-inputs="vm.findInputs('periodicity')"></ttype-actions-input-select>
                    </div>
                </div>
            </div>
            <div flex="33" layout="row">

                <div flex="20">
                    <md-button
                            class="md-icon-button md-raised {{!!item.instrument_accrual_calculation_schedules.accrual_calculation_model_toggle ? 'ref' : ''}}"
                            style="transform: scale(0.7,0.7)"
                            data-ng-click="vm.resetPropertyBtn(item, 'instrument_accrual_calculation_schedules', 'accrual_calculation_model')">
                        <span data-ng-if="!!item.instrument_accrual_calculation_schedules.accrual_calculation_model_toggle">R</span>
                        <span data-ng-if="!!!item.instrument_accrual_calculation_schedules.accrual_calculation_model_toggle">I</span>
                    </md-button>
                </div>
                <div flex="80">
                    <div data-ng-if="item.instrument_accrual_calculation_schedules.accrual_calculation_model_toggle">
                        <!--<md-input-container>
                            <label for="" class="uncut-text-on-focus-label" content-title>Accrual calculation model</label>
                            <md-select data-ng-model="item.instrument_accrual_calculation_schedules.accrual_calculation_model"
                                       md-on-open="vm.loadRelation('accrual_calculation_model')"
                                       md-container-class="simple-search-select">
                                <md-option
                                        data-ng-if="!vm.relationItems['accrual_calculation_model'].length"
                                        ng-value="item.instrument_accrual_calculation_schedules.accrual_calculation_model_object.id">
                                    {{item.instrument_accrual_calculation_schedules.accrual_calculation_model_object.name}}
                                </md-option>
                                <md-option
                                        data-ng-if="vm.relationItems['accrual_calculation_model'].length"
                                        data-ng-repeat="relationItem in vm.relationItems['accrual_calculation_model']"
                                        ng-value="relationItem.id">
                                    {{relationItem.name}}
                                </md-option>
                            </md-select>
                        </md-input-container>-->

                        <ttype-actions-relations-select
                                label-title="Accrual calculation model"
                                model="item.instrument_accrual_calculation_schedules.accrual_calculation_model"
                                load-relation="vm.loadRelation('accrual_calculation_model')"
                                relation-items="vm.relationItems['accrual_calculation_model']"
                                selected-value="item.instrument_accrual_calculation_schedules.accrual_calculation_model_object.id"
                                selected-name="item.instrument_accrual_calculation_schedules.accrual_calculation_model_object.name"></ttype-actions-relations-select>
                    </div>
                    <div data-ng-if="!item.instrument_accrual_calculation_schedules.accrual_calculation_model_toggle">
                        <!--<md-input-container>
                            <label for="" class="uncut-text-on-focus-label" content-title>Accrual calculation model</label>
                            <md-select
                                    data-ng-model="item.instrument_accrual_calculation_schedules.accrual_calculation_model_input">
                                <md-option
                                        data-ng-repeat="inputItem in vm.findInputs('accrual_calculation_model')"
                                        ng-value="inputItem.name">
                                    {{inputItem.name}}
                                </md-option>
                            </md-select>
                        </md-input-container>-->

                        <ttype-actions-input-select label-title="Accrual calculation model"
                                                    model="item.instrument_accrual_calculation_schedules.accrual_calculation_model_input"
                                                    find-inputs="vm.findInputs('accrual_calculation_model')"></ttype-actions-input-select>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>